{"version":3,"sources":["Wizard.js"],"names":["define","$","Imagemap","document","ready","configuration","window","imagemap","$image","areaEditor","AreaEditor","width","parseInt","css","height","top","form","initializeScaleFactor","scaleFactor","$zoomOut","$zoomIn","initializeScaling","setScale","show","hide","click","initializeAreas","areas","forEach","shape","addRect","addCircle","addPoly","initializeEvents","on","color","coords","$field","opener","itemName","val","persistanceXML","trigger","close","mousedown","bind","mouseup","mousemove","dblclick","existingAreas"],"mappings":"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","file":"Wizard.js","sourcesContent":["define(['jquery', 'TYPO3/CMS/Imagemap/Imagemap', 'jquery-ui/sortable', 'jquery-ui/draggable'], function ($, Imagemap) {\n\t$(document).ready(function () {\n\t\tlet configuration = window.imagemap,\n\t\t\t$image = $('#image img'),\n\t\t\tareaEditor = new Imagemap.AreaEditor('canvas', {\n\t\t\t\twidth: parseInt($image.css('width')),\n\t\t\t\theight: parseInt($image.css('height')),\n\t\t\t\ttop: parseInt($image.css('height')) * -1,\n\t\t\t\tform: 'areaForms'\n\t\t\t});\n\n\t\tconfiguration.areaEditor = areaEditor;\n\n\t\tlet initializeScaleFactor = (scaleFactor) => {\n\t\t\tlet $zoomOut = $('> .zout', '#magnify'),\n\t\t\t\t$zoomIn = $('> .zin', '#magnify');\n\n\t\t\tscaleFactor = areaEditor.initializeScaling(scaleFactor);\n\t\t\tareaEditor.setScale(scaleFactor);\n\n\t\t\tif (scaleFactor < 1) {\n\t\t\t\t$zoomIn.show();\n\t\t\t\t$zoomOut.hide();\n\t\t\t} else {\n\t\t\t\t$zoomIn.hide();\n\t\t\t\t$zoomOut.hide();\n\t\t\t}\n\n\t\t\t$zoomIn.click(() => {\n\t\t\t\tareaEditor.setScale(1);\n\t\t\t\t$zoomIn.hide();\n\t\t\t\t$zoomOut.show();\n\t\t\t});\n\n\t\t\t$zoomOut.click(() => {\n\t\t\t\tareaEditor.setScale(scaleFactor);\n\t\t\t\t$zoomOut.hide();\n\t\t\t\t$zoomIn.show();\n\t\t\t});\n\t\t};\n\n\t\tlet initializeAreas = (areas) => {\n\t\t\tareas.forEach((configuration) => {\n\t\t\t\tswitch (configuration.shape) {\n\t\t\t\t\tcase 'rect':\n\t\t\t\t\t\tareaEditor.addRect(configuration);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'circle':\n\t\t\t\t\t\tareaEditor.addCircle(configuration);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'poly':\n\t\t\t\t\t\tareaEditor.addPoly(configuration);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tlet initializeEvents = () => {\n\t\t\t$('#addRect').on('click', function () {\n\t\t\t\tareaEditor.addRect({\n\t\t\t\t\tcolor: '#ff0',\n\t\t\t\t\tcoords: (parseInt($image.css('width')) / 2 - 50) + ',' + (parseInt($image.css('height')) / 2 - 50)\n\t\t\t\t\t\t+ ',' + (parseInt($image.css('width')) / 2 + 50) + ',' + (parseInt($image.css('height')) / 2 + 50),\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t$('#addCircle').on('click', function () {\n\t\t\t\tareaEditor.addCircle({\n\t\t\t\t\tcolor: '#ff0',\n\t\t\t\t\tcoords: (parseInt($image.css('width')) / 2 - 50) + ',' + (parseInt($image.css('height')) / 2 - 50) + ',50',\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t$('#addPoly').on('click', function () {\n\t\t\t\tareaEditor.addPoly({\n\t\t\t\t\tcolor: '#ff0',\n\t\t\t\t\tcoords: (parseInt($image.css('width')) / 2) + ',' + (parseInt($image.css('height')) / 2 - 50)\n\t\t\t\t\t\t+ ',' + (parseInt($image.css('width')) / 2 + 50) + ',' + (parseInt($image.css('height')) / 2 + 50)\n\t\t\t\t\t\t+ ',' + (parseInt($image.css('width')) / 2 - 50) + ',' + (parseInt($image.css('height')) / 2 + 50)\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t$('#submit').on('click', function () {\n\t\t\t\tlet $field = window.opener.$('input[name=\"' + configuration.itemName + '\"]');\n\t\t\t\t$field\n\t\t\t\t\t.val('<map>' + areaEditor.persistanceXML() + '</map>')\n\t\t\t\t\t.trigger('imagemap:changed');\n\t\t\t\tclose();\n\t\t\t});\n\n\t\t\t$('#canvas')\n\t\t\t\t.on('mousedown', areaEditor.mousedown.bind(areaEditor))\n\t\t\t\t.on('mouseup', areaEditor.mouseup.bind(areaEditor))\n\t\t\t\t.on('mousemove', areaEditor.mousemove.bind(areaEditor))\n\t\t\t\t.on('dblclick', areaEditor.dblclick.bind(areaEditor));\n\t\t};\n\n\t\tinitializeScaleFactor(configuration.scaleFactor);\n\t\tinitializeAreas(configuration.existingAreas);\n\t\tinitializeEvents();\n\t});\n});\n"]}