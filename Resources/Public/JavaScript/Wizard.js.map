{"version":3,"sources":["Wizard.js"],"names":["define","$","AreaEditor","document","ready","configuration","window","imagemap","defaultAttributeSet","defaultAttributeset","$zoomIn","areaEditor","scaleFactor","initializeScaling","setScale","originX","originY","top","left","width","height","fill","$zoomOut","on","addArea","opener","itemName","val","persistanceXML","$field","close","mousedown","bind","mouseup","mousemove","dblclick"],"mappings":"oeAAAA,OAAA,CAAA,SAAA,gCAAA,qBAAA,uBAAA,SAAAC,EAAAC,GACAD,EAAAE,UAAAC,MAAA,WACA,IAAAC,EAAAC,OAAAC,SACAC,EAAAH,EAAAI,oBAHAT,EAAAA,EAAAA,YACAC,EAAAA,EAAAA,UAAAA,YACAS,EAAAT,EAAA,SAAA,YAAAU,EAAA,IAAAT,EAAA,SAAA,UAAA,aAwCAS,SAAAA,EAAAA,GACAV,EAAAA,IAAAA,IAAAA,OAAAA,OAAAA,EAAAA,SAAAA,GAAAA,GAAAA,GAAAA,GAAAA,EAAAA,GAzCAW,EAAAD,EAAAE,kBAAAD,GAAAD,EAAAG,SAAAF,GAAAP,EAAAM,WAAAA,EAQAA,EAAAA,cAAAA,QAAAA,SAAAA,GAAAA,IAAAA,EACAN,EAAAA,OAAAA,MAAAA,KAAAA,EADAM,EACAN,KAAAA,EADAM,EACAN,IAAAA,EADAM,EACAN,MAAAA,EADAM,EACAN,OAEAA,EAAAA,IAAAA,OAAAA,OAAAA,EAAAA,OAAAA,cAAAA,GAAAA,EAAAA,CAAAU,QAAA,OAAAC,QAAA,MAAAC,IAAAA,EAAAC,KAAAA,EAQAC,MAAAA,EANAC,OAAAA,EAEAL,KAAAA,EAAAA,SAEAE,EAAAA,IAAAA,KAGAG,EAAAA,GAGAT,EAAAA,OAFAU,EAAAA,OAMAC,EAAAA,MAAAA,WACAX,EAAAG,SAAA,GACAJ,EAAAA,MAAAA,OACAY,EAAAA,SAGAZ,EAAAA,MAAAA,WACAC,EAAAA,SAAAA,GACAV,EAAAA,MAAAA,OACAqB,EAAAA,SAaArB,EAAA,YAAAsB,GAAA,QAAA,WAJAC,EAAA,UAQAvB,EAAA,YAAAsB,GAAA,QAAA,WAJAtB,EAAAA,UAIAA,EAAAA,cAAAA,GAAAA,QAAAA,WACAuB,EAAAA,YAIAA,EAAAA,WAAAA,GAAAA,QAAAA,WACAlB,OAAAmB,OAAAxB,EAAA,eAAAI,EAAAqB,SAAA,MAGAC,IAAA,QAAAhB,EAAAiB,iBAAA,UACAC,QAAAA,oBAGAC,UAQA7B,EAAA,WACAsB,GAAA,YAAAZ,EAAAoB,UAAAC,KAAArB,IAJAY,GAAA,UAAAZ,EAAAsB,QAAAD,KAAArB,IACAY,GAAA,YAAAZ,EAAAuB,UAAAF,KAAArB,IACAY,GAAA,WAAAZ,EAAAwB,SAAAH,KAAArB","file":"Wizard.js","sourcesContent":["define(['jquery', 'TYPO3/CMS/Imagemap/AreaEditor', 'jquery-ui/sortable', 'jquery-ui/draggable'], function ($, AreaEditor) {\n\t$(document).ready(function () {\n\t\tlet configuration = window.imagemap,\n\t\t\tdefaultAttributeSet = configuration.defaultAttributeset,\n\t\t\tscaleFactor = configuration.scaleFactor,\n\t\t\t$zoomOut = $('> .zout', '#magnify'),\n\t\t\t$zoomIn = $('> .zin', '#magnify'),\n\t\t\tareaEditor = new AreaEditor('canvas', 'picture', 'areaForms');\n\n\t\tscaleFactor = areaEditor.initializeScaling(scaleFactor);\n\t\tareaEditor.setScale(scaleFactor);\n\t\tconfiguration.areaEditor = areaEditor;\n\n\t\tconfiguration.existingAreas.forEach((configuration) => {\n\t\t\tlet {left, top, width, height} = configuration.coords.split(',');\n\t\t\tlet area = new window.fabric[configuration.shape]({\n\t\t\t\t...configuration,\n\t\t\t\toriginX: 'left',\n\t\t\t\toriginY: 'top',\n\t\t\t\ttop: top,\n\t\t\t\tleft: left,\n\t\t\t\twidth: width,\n\t\t\t\theight: height,\n\t\t\t\tfill: configuration.color,\n\t\t\t});\n\t\t\tareaEditor.add(area);\n\t\t});\n\n\t\tif (scaleFactor < 1) {\n\t\t\t$zoomOut.hide();\n\t\t} else {\n\t\t\t$zoomIn.hide();\n\t\t\t$zoomOut.hide();\n\t\t}\n\n\t\t$zoomIn.click(function () {\n\t\t\tareaEditor.setScale(1);\n\t\t\t$(this).hide();\n\t\t\t$zoomOut.show();\n\t\t});\n\n\t\t$zoomOut.click(function () {\n\t\t\tareaEditor.setScale(scaleFactor);\n\t\t\t$(this).hide();\n\t\t\t$zoomIn.show();\n\t\t});\n\n\t\tfunction addArea (shape) {\n\t\t\tareaEditor.add(new window['area' + shape + 'Class'](), '', '', '', '', 1, defaultAttributeSet);\n\t\t}\n\n\t\t$('#addRect').on('click', function () {\n\t\t\taddArea('Rect');\n\t\t});\n\n\t\t$('#addPoly').on('click', function () {\n\t\t\taddArea('Poly');\n\t\t});\n\n\t\t$('#addCircle').on('click', function () {\n\t\t\taddArea('Circle');\n\t\t});\n\n\t\t$('#submit').on('click', function () {\n\t\t\tlet $field = window.opener.$('input[name=\"' + configuration.itemName + '\"]');\n\t\t\t$field\n\t\t\t\t.val('<map>' + areaEditor.persistanceXML() + '</map>')\n\t\t\t\t.trigger('imagemap:changed');\n\t\t\tclose();\n\t\t});\n\n\t\t$('#canvas')\n\t\t\t.on('mousedown', areaEditor.mousedown.bind(areaEditor))\n\t\t\t.on('mouseup', areaEditor.mouseup.bind(areaEditor))\n\t\t\t.on('mousemove', areaEditor.mousemove.bind(areaEditor))\n\t\t\t.on('dblclick', areaEditor.dblclick.bind(areaEditor));\n\t});\n});\n"]}