{"version":3,"sources":["Wizard.js"],"names":["define","$","Imagemap","document","ready","configuration","window","imagemap","defaultAttributeSet","defaultAttributeset","areaEditor","AreaEditor","initializeScaleFactor","scaleFactor","$zoomOut","$zoomIn","initializeScaling","setScale","show","hide","click","initializeAreas","areas","forEach","coords","split","left","top","width","height","area","shape","originX","originY","fill","color","add","initializeEvents","addArea","on","$field","opener","itemName","val","persistanceXML","trigger","close","existingAreas"],"mappings":"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","file":"Wizard.js","sourcesContent":["define(['jquery', 'TYPO3/CMS/Imagemap/Imagemap', 'jquery-ui/sortable', 'jquery-ui/draggable'], function ($, Imagemap) {\n\t$(document).ready(function () {\n\t\tlet configuration = window.imagemap,\n\t\t\tdefaultAttributeSet = configuration.defaultAttributeset,\n\t\t\tareaEditor = new Imagemap.AreaEditor('canvas', 'picture', 'areaForms');\n\n\t\tconfiguration.areaEditor = areaEditor;\n\n\t\tlet initializeScaleFactor = (scaleFactor) => {\n\t\t\tlet $zoomOut = $('> .zout', '#magnify'),\n\t\t\t\t$zoomIn = $('> .zin', '#magnify');\n\n\t\t\tscaleFactor = areaEditor.initializeScaling(scaleFactor);\n\t\t\tareaEditor.setScale(scaleFactor);\n\n\t\t\tif (scaleFactor < 1) {\n\t\t\t\t$zoomIn.show();\n\t\t\t\t$zoomOut.hide();\n\t\t\t} else {\n\t\t\t\t$zoomIn.hide();\n\t\t\t\t$zoomOut.hide();\n\t\t\t}\n\n\t\t\t$zoomIn.click(() => {\n\t\t\t\tareaEditor.setScale(1);\n\t\t\t\t$zoomIn.hide();\n\t\t\t\t$zoomOut.show();\n\t\t\t});\n\n\t\t\t$zoomOut.click(() => {\n\t\t\t\tareaEditor.setScale(scaleFactor);\n\t\t\t\t$zoomOut.hide();\n\t\t\t\t$zoomIn.show();\n\t\t\t});\n\t\t};\n\n\t\tlet initializeAreas = (areas) => {\n\t\t\tareas.forEach((configuration) => {\n\t\t\t\tlet {left, top, width, height} = configuration.coords.split(',');\n\t\t\t\tlet area = new Imagemap[configuration.shape]({\n\t\t\t\t\t...configuration,\n\t\t\t\t\toriginX: 'left',\n\t\t\t\t\toriginY: 'top',\n\t\t\t\t\ttop: top,\n\t\t\t\t\tleft: left,\n\t\t\t\t\twidth: width,\n\t\t\t\t\theight: height,\n\t\t\t\t\tfill: configuration.color,\n\t\t\t\t});\n\t\t\t\tareaEditor.add(area);\n\t\t\t});\n\t\t};\n\n\t\tlet initializeEvents = () => {\n\t\t\tlet addArea = (shape) => {\n\t\t\t\tareaEditor.add(new Imagemap[shape](), '', '', '', '', 1, defaultAttributeSet);\n\t\t\t};\n\n\t\t\t$('#addRect').on('click', function () {\n\t\t\t\taddArea('Rect');\n\t\t\t});\n\n\t\t\t$('#addPoly').on('click', function () {\n\t\t\t\taddArea('Poly');\n\t\t\t});\n\n\t\t\t$('#addCircle').on('click', function () {\n\t\t\t\taddArea('Circle');\n\t\t\t});\n\n\t\t\t$('#submit').on('click', function () {\n\t\t\t\tlet $field = window.opener.$('input[name=\"' + configuration.itemName + '\"]');\n\t\t\t\t$field\n\t\t\t\t\t.val('<map>' + areaEditor.persistanceXML() + '</map>')\n\t\t\t\t\t.trigger('imagemap:changed');\n\t\t\t\tclose();\n\t\t\t});\n\n\t\t\t/*$('#canvas')\n\t\t\t\t.on('mousedown', areaEditor.mousedown.bind(areaEditor))\n\t\t\t\t.on('mouseup', areaEditor.mouseup.bind(areaEditor))\n\t\t\t\t.on('mousemove', areaEditor.mousemove.bind(areaEditor))\n\t\t\t\t.on('dblclick', areaEditor.dblclick.bind(areaEditor));*/\n\t\t};\n\n\t\tinitializeScaleFactor(configuration.scaleFactor);\n\t\tinitializeAreas(configuration.existingAreas);\n\t\tinitializeEvents();\n\t});\n});\n"]}