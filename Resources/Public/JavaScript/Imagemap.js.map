{"version":3,"sources":["Imagemap.es6"],"names":["define","$","fabric","imagemap","Rect","options","form","subForm","setValues","addEvents","querySelectorAll","forEach","field","id","style","backgroundColor","color","value","width","left","height","top","bind","button","addEventListener","deleteArea","remove","showElement","hideElement","selector","querySelector","getElement","classList","add","getAreaCoords","getAdditionalAttributes","getLink","join","result","push","AreaEditor","rgbAToHex","length","Circle","link","alt","radius","Polygon","coordForm","coords","AreaForm","formElement","editor","element","document","areas","DOMParser","parseFromString","innerHTML","body","firstChild","area","getFormElement","addArea","postInitializeForm","insertBefore","currentArea","blur","data","window","browseLink","objectId","getId","currentValue","ajax","url","TYPO3","settings","ajaxUrls","context","done","response","console","log","vHWin","open","focus","xml","toAreaXml","canvas","preview","initializeOptions","Canvas","option","hasOwnProperty","scaling","parseInt","scaleFactor","configuration","split","right","bottom","borderColor","stroke","strokeWidth","fill","hexToRgbA","addRect","addCircle","coordsXY","i","points","Error","xy","x","y","Math","min","addPoly","hex","alpha","chars","r","g","b","test","substring","rgba","numbers","replace","rgb","toString","slice","toUpperCase"],"mappings":"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","file":"Imagemap.js","sourcesContent":["define(['jquery', 'TYPO3/CMS/Imagemap/Fabric'], ($, fabric) => {\n\tlet imagemap = imagemap || {};\n\n\tclass Rect extends fabric.Rect {\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\n\t\t\tthis.form = null;\n\t\t\tthis.subForm = null;\n\t\t}\n\n\t\tpostInitializeForm() {\n\t\t\tthis.setValues();\n\t\t\tthis.addEvents();\n\t\t}\n\n\t\tsetValues() {\n\t\t\tthis.subForm.querySelectorAll('.t3js-field').forEach(function (field) {\n\t\t\t\tswitch (field.id) {\n\t\t\t\t\tcase 'color':\n\t\t\t\t\t\tfield.style.backgroundColor = this.color;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tfield.value = this.width + this.left;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'bottom':\n\t\t\t\t\t\tfield.value = this.height + this.top;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tfield.value = this[field.id] ? this[field.id] : '';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t}\n\n\t\taddEvents() {\n\t\t\tthis.subForm.querySelectorAll('.t3js-btn').forEach(function (button) {\n\t\t\t\tbutton.addEventListener('click', this[button.id + 'Action'].bind(this));\n\t\t\t}.bind(this));\n\t\t}\n\n\t\tlinkAction() {\n// var area = jQuery(this).parents('.areaForm').data('area'); area.getCanvas().openPopup(this, area);\n\t\t}\n\n\t\tupAction() {\n\t\t}\n\n\t\tdownAction() {\n\t\t}\n\n\t\tundoAction() {\n\t\t}\n\n\t\tredoAction() {\n\t\t}\n\n\t\tdeleteAction() {\n\t\t\tthis.form.deleteArea(this);\n\t\t\tthis.subForm.remove();\n\t\t\tdelete this;\n\t\t}\n\n\t\texpandAction() {\n\t\t\tthis.showElement('.moreOptions');\n\t\t\tthis.hideElement('#expand');\n\t\t\tthis.showElement('#collaps');\n\t\t}\n\n\t\tcollapseAction() {\n\t\t\tthis.hideElement('.moreOptions');\n\t\t\tthis.hideElement('#collaps');\n\t\t\tthis.showElement('#expand');\n\t\t}\n\n\t\tgetElement(selector) {\n\t\t\treturn this.subForm.querySelector(selector);\n\t\t}\n\n\t\thideElement(selector) {\n\t\t\tthis.getElement(selector).classList.add('hide');\n\t\t}\n\n\t\tshowElement(selector) {\n\t\t\tthis.getElement(selector).classList.remove('hide');\n\t\t}\n\n\t\ttoAreaXml() {\n\t\t\treturn [\n\t\t\t\t'<area shape=\"rect\"',\n\t\t\t\t' coords=\"' + this.getAreaCoords() + '\"',\n\t\t\t\tthis.getAdditionalAttributes() + '>',\n\t\t\t\tthis.getLink(),\n\t\t\t\t'</area>'\n\t\t\t].join('');\n\t\t}\n\n\t\tgetAreaCoords() {\n\t\t\treturn [this.left, this.top, (this.left + this.width), (this.height + this.top)].join(',');\n\t\t}\n\n\t\tgetLink() {\n\t\t\treturn this.subForm.querySelector('#link').value;\n\t\t}\n\n\t\tgetAdditionalAttributes() {\n\t\t\tlet result = [];\n\n\t\t\tif (this.subForm.querySelector('#title').value) {\n\t\t\t\tresult.push('alt=\"' + this.subForm.querySelector('#title').value + '\"');\n\t\t\t}\n\n\t\t\tif (this.subForm.querySelector('#color')) {\n\t\t\t\tresult.push('color=\"' + AreaEditor.rgbAToHex(\n\t\t\t\t\tthis.subForm.querySelector('#color').style.backgroundColor\n\t\t\t\t) + '\"');\n\t\t\t}\n\n\t\t\treturn (result.length > 0 ? ' ' : '') + result.join(' ');\n\t\t}\n\t}\n\n\tclass Circle extends fabric.Circle {\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\n\t\t\tthis.form = null;\n\t\t\tthis.subForm = null;\n\t\t}\n\n\t\tpostInitializeForm() {\n\t\t\tthis.setValues();\n\t\t\tthis.addEvents();\n\t\t}\n\n\t\tsetValues() {\n\t\t\tthis.subForm.querySelector('#link').value = this.link;\n\t\t\tthis.subForm.querySelector('#label').value = this.alt;\n\t\t\tthis.subForm.querySelector('.colorPreview > div').style.backgroundColor = this.color;\n\t\t}\n\n\t\taddEvents() {\n\t\t\tthis.subForm.querySelectorAll('.t3js-btn').forEach(function (button) {\n\t\t\t\tbutton.addEventListener('click', this[button.id + 'Action'].bind(this));\n\t\t\t}.bind(this));\n\t\t}\n\n\t\tlinkAction() {\n// var area = jQuery(this).parents('.areaForm').data('area'); area.getCanvas().openPopup(this, area);\n\t\t}\n\n\t\tupAction() {\n\t\t}\n\n\t\tdownAction() {\n\t\t}\n\n\t\tundoAction() {\n\t\t}\n\n\t\tredoAction() {\n\t\t}\n\n\t\tdeleteAction() {\n\t\t\tthis.form.deleteArea(this);\n\t\t\tthis.subForm.remove();\n\t\t\tdelete this;\n\t\t}\n\n\t\texpandAction() {\n\t\t\tthis.showElement('.moreOptions');\n\t\t\tthis.hideElement('#expand');\n\t\t\tthis.showElement('#collaps');\n\t\t}\n\n\t\tcollapseAction() {\n\t\t\tthis.hideElement('.moreOptions');\n\t\t\tthis.hideElement('#collaps');\n\t\t\tthis.showElement('#expand');\n\t\t}\n\n\t\tgetElement(selector) {\n\t\t\treturn this.subForm.querySelector(selector);\n\t\t}\n\n\t\thideElement(selector) {\n\t\t\tthis.getElement(selector).classList.add('hide');\n\t\t}\n\n\t\tshowElement(selector) {\n\t\t\tthis.getElement(selector).classList.remove('hide');\n\t\t}\n\n\t\ttoAreaXml() {\n\t\t\treturn [\n\t\t\t\t'<area shape=\"circle\"',\n\t\t\t\t' coords=\"' + this.getAreaCoords() + '\"',\n\t\t\t\tthis.getAdditionalAttributes() + '>',\n\t\t\t\tthis.getLink(),\n\t\t\t\t'</area>'\n\t\t\t].join('');\n\t\t}\n\n\t\tgetAreaCoords() {\n\t\t\treturn this.left + ',' + this.top + ',' + this.radius;\n\t\t}\n\n\t\tgetLink() {\n\t\t\treturn this.subForm.querySelector('#link').value;\n\t\t}\n\n\t\tgetAdditionalAttributes() {\n\t\t\tlet result = [];\n\n\t\t\tif (this.subForm.querySelector('#title').value) {\n\t\t\t\tresult.push('alt=\"' + this.subForm.querySelector('#title').value + '\"');\n\t\t\t}\n\n\t\t\tif (this.subForm.querySelector('#color')) {\n\t\t\t\tresult.push('color=\"' + AreaEditor.rgbAToHex(\n\t\t\t\t\tthis.subForm.querySelector('#color').style.backgroundColor\n\t\t\t\t) + '\"');\n\t\t\t}\n\n\t\t\treturn (result.length > 0 ? ' ' : '') + result.join(' ');\n\t\t}\n\t}\n\n\tclass Polygon extends fabric.Polygon {\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\n\t\t\tthis.form = null;\n\t\t\tthis.subForm = null;\n\t\t\tthis.coordForm = null;\n\t\t}\n\n\t\tpostInitializeForm() {\n\t\t\tthis.setValues();\n\t\t\tthis.addEvents();\n\t\t}\n\n\t\tsetValues() {\n\t\t\tthis.subForm.querySelector('#link').value = this.link;\n\t\t\tthis.subForm.querySelector('#label').value = this.alt;\n\t\t\tthis.subForm.querySelector('.colorPreview > div').style.backgroundColor = this.color;\n\t\t}\n\n\t\taddEvents() {\n\t\t\tthis.subForm.querySelectorAll('.t3js-btn').forEach(function (button) {\n\t\t\t\tbutton.addEventListener('click', this[button.id + 'Action'].bind(this));\n\t\t\t}.bind(this));\n\t\t}\n\n\t\tlinkAction() {\n// var area = jQuery(this).parents('.areaForm').data('area'); area.getCanvas().openPopup(this, area);\n\t\t}\n\n\t\tupAction() {\n\t\t}\n\n\t\tdownAction() {\n\t\t}\n\n\t\tundoAction() {\n\t\t}\n\n\t\tredoAction() {\n\t\t}\n\n\t\tdeleteAction() {\n\t\t\tthis.form.deleteArea(this);\n\t\t\tthis.subForm.remove();\n\t\t\tthis.coordForm.remove();\n\t\t\tdelete this;\n\t\t}\n\n\t\taddAction() {\n\t\t}\n\n\t\texpandAction() {\n\t\t\tthis.showElement('.moreOptions');\n\t\t\tthis.hideElement('#expand');\n\t\t\tthis.showElement('#collaps');\n\t\t}\n\n\t\tcollapseAction() {\n\t\t\tthis.hideElement('.moreOptions');\n\t\t\tthis.hideElement('#collaps');\n\t\t\tthis.showElement('#expand');\n\t\t}\n\n\t\tgetElement(selector) {\n\t\t\treturn this.subForm.querySelector(selector);\n\t\t}\n\n\t\thideElement(selector) {\n\t\t\tthis.getElement(selector).classList.add('hide');\n\t\t}\n\n\t\tshowElement(selector) {\n\t\t\tthis.getElement(selector).classList.remove('hide');\n\t\t}\n\n\t\ttoAreaXml() {\n\t\t\tlet coords = this.getAreaCoords();\n\t\t\treturn [\n\t\t\t\t'<area shape=\"poly\"',\n\t\t\t\t' coords=\"' + coords + '\"',\n\t\t\t\tthis.getAdditionalAttributes() + '>',\n\t\t\t\tthis.getLink(),\n\t\t\t\t'</area>'\n\t\t\t].join('');\n\t\t}\n\n\t\tgetAreaCoords() {\n\n\t\t}\n\n\t\tgetLink() {\n\t\t\treturn this.subForm.querySelector('#link').value;\n\t\t}\n\n\t\tgetAdditionalAttributes() {\n\t\t\tlet result = [];\n\n\t\t\tif (this.subForm.querySelector('#title').value) {\n\t\t\t\tresult.push('alt=\"' + this.subForm.querySelector('#title').value + '\"');\n\t\t\t}\n\n\t\t\tif (this.subForm.querySelector('#color')) {\n\t\t\t\tresult.push('color=\"' + AreaEditor.rgbAToHex(\n\t\t\t\t\tthis.subForm.querySelector('#color').style.backgroundColor\n\t\t\t\t) + '\"');\n\t\t\t}\n\n\t\t\treturn (result.length > 0 ? ' ' : '') + result.join(' ');\n\t\t}\n\t}\n\n\tclass AreaForm {\n\t\tconstructor(formElement, editor) {\n\t\t\tthis.element = fabric.document.querySelector('#' + formElement);\n\t\t\tthis.editor = editor;\n\t\t\tthis.areas = [];\n\t\t}\n\n\t\tgetFormElement(selector) {\n\t\t\treturn new DOMParser().parseFromString(\n\t\t\t\tthis.element.querySelector(selector).innerHTML,\n\t\t\t\t'text/html'\n\t\t\t).body.firstChild;\n\t\t}\n\n\t\taddRect(area) {\n\t\t\tarea.form = this;\n\t\t\tarea.subForm = this.getFormElement('#rectForm');\n\n\t\t\tthis.addArea(area);\n\t\t\tarea.postInitializeForm();\n\t\t}\n\n\t\taddCircle(area) {\n\t\t\tarea.form = this;\n\t\t\tarea.subForm = this.getFormElement('#circForm');\n\n\t\t\tthis.addArea(area);\n\t\t\tarea.postInitializeForm();\n\t\t}\n\n\t\taddPoly(area) {\n\t\t\tarea.form = this;\n\t\t\tarea.subForm = this.getFormElement('#polyForm');\n\t\t\tarea.coordForm = this.getFormElement('#polyCoords');\n\n\t\t\tthis.addArea(area);\n\t\t\tarea.postInitializeForm();\n\t\t}\n\n\t\taddArea(area) {\n\t\t\tthis.areas.push(area);\n\t\t\tthis.element.insertBefore(area.subForm, this.element.firstChild);\n\t\t}\n\n\t\tdeleteArea(area) {\n\t\t\tlet areas = [];\n\t\t\tthis.areas.forEach((currentArea) => {\n\t\t\t\tif (area !== currentArea) {\n\t\t\t\t\tareas.push(currentArea);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.areas = areas;\n\t\t\tthis.editor.deleteArea(area);\n\t\t}\n\n\t\topenPopup(link, area) {\n\t\t\tlink.blur();\n\n\t\t\tlet data = window.imagemap.browseLink;\n\t\t\tdata.objectId = area.getId();\n\t\t\tdata.currentValue = area.getLink();\n\n\t\t\t$.ajax({\n\t\t\t\turl: TYPO3.settings.ajaxUrls['imagemap_browselink_url'],\n\t\t\t\tcontext: area,\n\t\t\t\tdata: data\n\t\t\t}).done(function (response) {\n\t\t\t\tconsole.log(response);\n\t\t\t\tlet vHWin = window.open(response.url, '', 'height=600,width=500,status=0,menubar=0,scrollbars=1'); vHWin.focus()\n\t\t\t});\n\t\t}\n\n\t\ttoAreaXml() {\n\t\t\tlet xml = ['<map>'];\n\t\t\tthis.areas.forEach((area) => {\n\t\t\t\txml.push(area.toAreaXml());\n\t\t\t});\n\t\t\txml.push('</map>');\n\t\t\treturn xml.join(\"\\n\");\n\t\t}\n\t}\n\n\tclass AreaEditor {\n\t\tconstructor(canvas, form, options) {\n\t\t\tthis.preview = false;\n\t\t\tthis.initializeOptions(options);\n\n\t\t\tthis.canvas = new fabric.Canvas(canvas, options.canvas);\n\t\t\tif (!this.preview) {\n\t\t\t\tthis.form = new AreaForm(form, this);\n\t\t\t}\n\t\t}\n\n\t\tinitializeOptions(options) {\n\t\t\tfor (let option in options) {\n\t\t\t\tif (options.hasOwnProperty(option)) {\n\t\t\t\t\tthis[option] = options[option];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinitializeScaling(scaling) {\n\t\t\tlet width = parseInt(scaling) / this.canvas.width,\n\t\t\t\theight = parseInt(scaling) / this.canvas.height;\n\t\t\treturn (width > height) ? height : width;\n\t\t}\n\t\tsetScale(scaling) {\n\t\t\tthis.scaleFactor = scaling > 1 ? 1 : scaling;\n\t\t}\n\t\tgetMaxWidth() {\n\t\t\treturn this.scaleFactor * this.canvas.width;\n\t\t}\n\t\tgetMaxHeight() {\n\t\t\treturn this.scaleFactor * this.canvas.height;\n\t\t}\n\n\t\taddRect(configuration) {\n\t\t\tlet [left, top, right, bottom] = configuration.coords.split(','),\n\t\t\t\tarea = new Rect({\n\t\t\t\t\t...configuration,\n\t\t\t\t\tleft: parseInt(left),\n\t\t\t\t\ttop: parseInt(top),\n\t\t\t\t\twidth: right - left,\n\t\t\t\t\theight: bottom - top,\n\t\t\t\t\tborderColor: configuration.color,\n\t\t\t\t\tstroke: configuration.color,\n\t\t\t\t\tstrokeWidth: 1,\n\t\t\t\t\tfill: AreaEditor.hexToRgbA(configuration.color, this.preview ? 0.001 : 0.2)\n\t\t\t\t});\n\n\t\t\tthis.canvas.add(area);\n\t\t\tif (this.form) {\n\t\t\t\tthis.form.addRect(area);\n\t\t\t}\n\t\t}\n\n\t\taddCircle(configuration) {\n\t\t\tlet [left, top, radius] = configuration.coords.split(','),\n\t\t\t\tarea = new Circle({\n\t\t\t\t\t...configuration,\n\t\t\t\t\tleft: parseInt(left),\n\t\t\t\t\ttop: parseInt(top),\n\t\t\t\t\tradius: parseInt(radius),\n\t\t\t\t\tborderColor: configuration.color,\n\t\t\t\t\tstroke: configuration.color,\n\t\t\t\t\tstrokeWidth: 1,\n\t\t\t\t\tfill: AreaEditor.hexToRgbA(configuration.color, this.preview ? 0.001 : 0.2)\n\t\t\t\t});\n\n\t\t\tthis.canvas.add(area);\n\t\t\tif (this.form) {\n\t\t\t\tthis.form.addCircle(area);\n\t\t\t}\n\t\t}\n\n\t\taddPoly(configuration) {\n\t\t\tlet coordsXY = configuration.coords.split(','),\n\t\t\t\tleft = 100000,\n\t\t\t\ttop = 100000,\n\t\t\t\ti = 0,\n\t\t\t\tpoints = [];\n\n\t\t\tif (coordsXY.length % 2) {\n\t\t\t\tthrow new Error('Bad coords count');\n\t\t\t}\n\n\t\t\tfor (; i < coordsXY.length; i = i + 2) {\n\t\t\t\tlet xy = {x: parseInt(coordsXY[i]), y: parseInt(coordsXY[i + 1])};\n\t\t\t\tpoints.push(xy);\n\n\t\t\t\tleft = Math.min(left, xy.x);\n\t\t\t\ttop = Math.min(top, xy.y);\n\t\t\t}\n\n\t\t\tlet area = new Polygon(points, {\n\t\t\t\t...configuration,\n\t\t\t\ttop: top,\n\t\t\t\tleft: left,\n\t\t\t\tborderColor: configuration.color,\n\t\t\t\tstroke: configuration.color,\n\t\t\t\tstrokeWidth: 1,\n\t\t\t\tfill: AreaEditor.hexToRgbA(configuration.color, this.preview ? 0.001 : 0.2)\n\t\t\t});\n\n\t\t\tthis.canvas.add(area);\n\t\t\tif (this.form) {\n\t\t\t\tthis.form.addPoly(area);\n\t\t\t}\n\t\t}\n\n\t\tstatic hexToRgbA(hex, alpha) {\n\t\t\tlet chars, r, g, b, result;\n\t\t\tif (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\n\t\t\t\tchars = hex.substring(1).split('');\n\t\t\t\tif (chars.length === 3) {\n\t\t\t\t\tchars = [chars[0], chars[0], chars[1], chars[1], chars[2], chars[2]];\n\t\t\t\t}\n\n\t\t\t\tr = parseInt(chars[0] + chars[1], 16);\n\t\t\t\tg = parseInt(chars[2] + chars[3], 16);\n\t\t\t\tb = parseInt(chars[4] + chars[5], 16);\n\n\t\t\t\tif (alpha) {\n\t\t\t\t\tresult = 'rgba(' + [r, g, b, alpha].join(', ') + ')';\n\t\t\t\t} else {\n\t\t\t\t\tresult = 'rgb(' + [r, g, b].join(', ') + ')';\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\tthrow new Error('Bad Hex');\n\t\t}\n\n\t\tstatic rgbAToHex(rgba) {\n\t\t\tlet numbers = rgba.replace(/[^0-9,]*/g, '').split(',');\n\n\t\t\tif (numbers.length < 3) {\n\t\t\t\tthrow new Error('Bad rgba');\n\t\t\t}\n\n\t\t\tlet rgb = numbers[2] | (numbers[1] << 8) | (numbers[0] << 16);\n\t\t\treturn '#' + (0x1000000 + rgb).toString(16).slice(1).toUpperCase();\n\t\t}\n\n\t\tdeleteArea(area) {\n\t\t\tthis.canvas.remove(area);\n\t\t}\n\n\t\ttoAreaXml() {\n\t\t\treturn this.form.toAreaXml();\n\t\t}\n\t}\n\timagemap.AreaEditor = AreaEditor;\n\n\treturn imagemap;\n});\n"]}