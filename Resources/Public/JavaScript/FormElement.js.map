{"version":3,"sources":["FormElement.es6"],"names":["define","$","AreaEditor","document","ready","scaleFactor","editorOptions","$control","$image","find","$canvas","canvas","width","parseInt","css","height","top","previewRerenderAjaxUrl","window","TYPO3","settings","ajaxUrls","imagemap_preview_rerender","areaEditor","data","setScale","on","event","$field","currentTarget","ajax","url","method","P","itemFormElName","attr","tableName","fieldName","uid","replace","value","val","done","textStatus","removeAllAreas","initializeAreas"],"mappings":"AAAAA,OAAA,CACA,SACA,gBACA,SAAAC,EAAAC,GACAD,EAAAE,UAAAC,MAAA,WACA,IAaAC,EAIAC,EAjBAC,EAAAN,EAAA,2BACAO,EAAAD,EAAAE,KAAA,cACAC,EAAAH,EAAAE,KAAA,YACAH,EAAA,CACAK,OAAA,CACAC,MAAAC,SAAAL,EAAAM,IAAA,UACAC,OAAAF,SAAAL,EAAAM,IAAA,WACAE,KAAA,EAAAH,SAAAL,EAAAM,IAAA,YAEAG,uBAAAC,OAAAC,MAAAC,SAAAC,SAAAC,2BAEAC,EAAA,IAAArB,EAAAI,EAAA,UAEAD,EA4BAK,EAAAc,KAAA,mBA3BAD,EAAAE,SAAApB,GAGAC,EAyBAA,EAxBAC,EAAAE,KAAA,sBAAAiB,GAAA,mBAAA,SAAAC,GACA,IAAAC,EAAA3B,EAAA0B,EAAAE,eACA5B,EAAA6B,KAAA,CACAC,IAAAzB,EAAAW,uBACAe,OAAA,OACAR,KAAA,CACAS,EAAA,CACAC,eAAAN,EAAAO,KAAA,QACAC,UAAA,aACAC,UAAA,oBACAC,IAAAV,EAAAO,KAAA,QAAAI,QAAA,oBAAA,IAAAA,QAAA,uBAAA,IACAC,MAAAZ,EAAAa,UAGAC,KAAA,SAAAlB,EAAAmB,GACA,YAAAA,IACApB,EAAAqB,iBACArB,EAAAsB,gBAAArB,QAQAD,EAAAsB,gBAAAnC,EAAAc,KAAA","file":"FormElement.js","sourcesContent":["define([\n\t'jquery',\n\t'./AreaEditor'\n], ($, AreaEditor) => {\n\t$(document).ready(() => {\n\t\tlet $control = $('.imagemap-control:eq(0)'),\n\t\t\t$image = $control.find('.image img'),\n\t\t\t$canvas = $control.find('.picture'),\n\t\t\teditorOptions = {\n\t\t\t\tcanvas: {\n\t\t\t\t\twidth: parseInt($image.css('width')),\n\t\t\t\t\theight: parseInt($image.css('height')),\n\t\t\t\t\ttop: parseInt($image.css('height')) * -1,\n\t\t\t\t},\n\t\t\t\tpreviewRerenderAjaxUrl: window.TYPO3.settings.ajaxUrls.imagemap_preview_rerender\n\t\t\t},\n\t\t\tareaEditor = new AreaEditor(editorOptions, 'canvas');\n\n\t\tlet initializeScaleFactor = (scaleFactor) => {\n\t\t\tareaEditor.setScale(scaleFactor);\n\t\t};\n\n\t\tlet initializeEvents = (editorOptions) => {\n\t\t\t$control.find('input[type=hidden]').on('imagemap:changed', (event) => {\n\t\t\t\tlet $field = $(event.currentTarget);\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: editorOptions.previewRerenderAjaxUrl,\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tP: {\n\t\t\t\t\t\t\titemFormElName: $field.attr('name'),\n\t\t\t\t\t\t\ttableName: 'tt_content',\n\t\t\t\t\t\t\tfieldName: 'tx_imagemap_links',\n\t\t\t\t\t\t\tuid: $field.attr('name').replace('data[tt_content][', '').replace('][tx_imagemap_links]', ''),\n\t\t\t\t\t\t\tvalue: $field.val()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).done((data, textStatus) => {\n\t\t\t\t\tif (textStatus === 'success') {\n\t\t\t\t\t\tareaEditor.removeAllAreas();\n\t\t\t\t\t\tareaEditor.initializeAreas(data);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tinitializeScaleFactor($canvas.data('thumbnail-scale'));\n\t\tinitializeEvents(editorOptions);\n\t\tareaEditor.initializeAreas($canvas.data('existing-areas'));\n\t});\n});\n"]}