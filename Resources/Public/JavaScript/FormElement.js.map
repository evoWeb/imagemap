{"version":3,"sources":["FormElement.es6"],"names":["define","$","AreaEditor","document","ready","$control","$image","find","$canvas","editorOptions","canvas","width","parseInt","css","height","top","areaEditor","initializeScaleFactor","scaleFactor","setScale","initializeAreas","areas","console","log","forEach","area","shape","addRect","addCircle","addPoly","initializeEvents","on","$field","ajax","url","window","TYPO3","settings","ajaxUrls","method","data","P","itemFormElName","attr","tableName","fieldName","uid","replace","value","val","done","textStatus","removeAreas"],"mappings":"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","file":"FormElement.js","sourcesContent":["define([\n\t'jquery',\n\t'TYPO3/CMS/Imagemap/AreaEditor',\n\t'jquery-ui/sortable',\n\t'jquery-ui/draggable',\n\t'TYPO3/CMS/Imagemap/JsGraphics'\n], ($, AreaEditor) => {\n\t$(document).ready(() => {\n\t\tlet $control = $('.imagemap-control:eq(0)'),\n\t\t\t$image = $control.find('.image img'),\n\t\t\t$canvas = $control.find('.picture'),\n\t\t\teditorOptions = {\n\t\t\t\tcanvas: {\n\t\t\t\t\twidth: parseInt($image.css('width')),\n\t\t\t\t\theight: parseInt($image.css('height')),\n\t\t\t\t\ttop: parseInt($image.css('height')) * -1,\n\t\t\t\t}\n\t\t\t},\n\t\t\tareaEditor = new AreaEditor(editorOptions, 'canvas');\n\n\t\tlet initializeScaleFactor = (scaleFactor) => {\n\t\t\tareaEditor.setScale(scaleFactor);\n\t\t};\n\n\t\tlet initializeAreas = (areas) => {\n\t\t\tconsole.log(areas);\n\t\t\tareas.forEach((area) => {\n\t\t\t\tswitch (area.shape) {\n\t\t\t\t\tcase 'rect':\n\t\t\t\t\t\tareaEditor.addRect(area);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'circle':\n\t\t\t\t\t\tareaEditor.addCircle(area);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'poly':\n\t\t\t\t\t\tareaEditor.addPoly(area);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tlet initializeEvents = () => {\n\t\t\t$control.find('input[type=hidden]').on('imagemap:changed', function () {\n\t\t\t\tlet $field = $(this);\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: window.TYPO3.settings.ajaxUrls['imagemap_preview_rerender'],\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tP: {\n\t\t\t\t\t\t\titemFormElName: $field.attr('name'),\n\t\t\t\t\t\t\ttableName: 'tt_content',\n\t\t\t\t\t\t\tfieldName: 'tx_imagemap_links',\n\t\t\t\t\t\t\tuid: $field.attr('name').replace('data[tt_content][', '').replace('][tx_imagemap_links]', ''),\n\t\t\t\t\t\t\tvalue: $field.val()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).done((data, textStatus) => {\n\t\t\t\t\tif (textStatus === 'success') {\n\t\t\t\t\t\tareaEditor.removeAreas();\n\t\t\t\t\t\tinitializeAreas(data);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tinitializeScaleFactor($canvas.data('thumbnail-scale'));\n\t\tinitializeAreas($canvas.data('existing-areas'));\n\t\tinitializeEvents();\n\t});\n});\n"]}