{"version":3,"sources":["FormElement.es6"],"names":["define","$","AreaEditor","document","ready","$control","$image","find","$canvas","editorOptions","canvas","width","parseInt","css","height","top","previewRerenderAjaxUrl","window","TYPO3","settings","ajaxUrls","imagemap_preview_rerender","canvasContainer","areaEditor","initializeScaleFactor","scaleFactor","setScale","initializeEvents","on","event","$field","currentTarget","ajax","url","method","data","P","itemFormElName","attr","tableName","fieldName","uid","replace","value","val","done","textStatus","removeAllAreas","initializeAreas"],"mappings":"AAAAA,MAAA,CAAA,CACA,QADA,EAEA,cAFA,CAAA,EAGA,UAAAC,CAAA,EAAAC,UAAA,EAAA;AACAD,EAAAA,CAAA,CAAAE,QAAA,CAAA,CAAAC,KAAA,CAAA,YAAA;AACA,QAAAC,QAAA,GAAAJ,CAAA,CAAA,yBAAA,CAAA;AAAA,QACAK,MAAA,GAAAD,QAAA,CAAAE,IAAA,CAAA,YAAA,CADA;AAAA,QAEAC,OAAA,GAAAH,QAAA,CAAAE,IAAA,CAAA,UAAA,CAFA;AAAA,QAGAE,aAAA,GAAA;AACAC,MAAAA,MAAA,EAAA;AACAC,QAAAA,KAAA,EAAAC,QAAA,CAAAN,MAAA,CAAAO,GAAA,CAAA,OAAA,CAAA,CADA;AAEAC,QAAAA,MAAA,EAAAF,QAAA,CAAAN,MAAA,CAAAO,GAAA,CAAA,QAAA,CAAA,CAFA;AAGAE,QAAAA,GAAA,EAAAH,QAAA,CAAAN,MAAA,CAAAO,GAAA,CAAA,QAAA,CAAA,CAAA,GAAA,CAAA;AAHA,OADA;AAMAG,MAAAA,sBAAA,EAAAC,MAAA,CAAAC,KAAA,CAAAC,QAAA,CAAAC,QAAA,CAAAC;AANA,KAHA;AAAA,QAWAC,eAAA,GAAAjB,QAAA,CAAAE,IAAA,CAAA,SAAA,EAAA,CAAA,CAXA;AAAA,QAYAgB,UAAA,GAAA,IAAArB,UAAA,CAAAO,aAAA,EAAAa,eAAA,EAAA,EAAA,EAAAL,MAAA,CAAAd,QAAA,CAZA;;AAcA,QAAAqB,qBAAA,GAAA,SAAAA,qBAAA,CAAAC,WAAA,EAAA;AACAF,MAAAA,UAAA,CAAAG,QAAA,CAAAD,WAAA;AACA,KAFA;;AAIA,QAAAE,gBAAA,GAAA,SAAAA,gBAAA,CAAAlB,aAAA,EAAA;AACAJ,MAAAA,QAAA,CAAAE,IAAA,CAAA,oBAAA,EAAAqB,EAAA,CAAA,kBAAA,EAAA,UAAAC,KAAA,EAAA;AACA,YAAAC,MAAA,GAAA7B,CAAA,CAAA4B,KAAA,CAAAE,aAAA,CAAA;AACA9B,QAAAA,CAAA,CAAA+B,IAAA,CAAA;AACAC,UAAAA,GAAA,EAAAxB,aAAA,CAAAO,sBADA;AAEAkB,UAAAA,MAAA,EAAA,MAFA;AAGAC,UAAAA,IAAA,EAAA;AACAC,YAAAA,CAAA,EAAA;AACAC,cAAAA,cAAA,EAAAP,MAAA,CAAAQ,IAAA,CAAA,MAAA,CADA;AAEAC,cAAAA,SAAA,EAAA,YAFA;AAGAC,cAAAA,SAAA,EAAA,mBAHA;AAIAC,cAAAA,GAAA,EAAAX,MAAA,CAAAQ,IAAA,CAAA,MAAA,EAAAI,OAAA,CAAA,mBAAA,EAAA,EAAA,EAAAA,OAAA,CAAA,sBAAA,EAAA,EAAA,CAJA;AAKAC,cAAAA,KAAA,EAAAb,MAAA,CAAAc,GAAA;AALA;AADA;AAHA,SAAA,EAYAC,IAZA,CAYA,UAAAV,IAAA,EAAAW,UAAA,EAAA;AACA,cAAAA,UAAA,KAAA,SAAA,EAAA;AACAvB,YAAAA,UAAA,CAAAwB,cAAA;AACAxB,YAAAA,UAAA,CAAAyB,eAAA,CAAAb,IAAA;AACA;AACA,SAjBA;AAkBA,OApBA;AAqBA,KAtBA;;AAwBAX,IAAAA,qBAAA,CAAAhB,OAAA,CAAA2B,IAAA,CAAA,iBAAA,CAAA,CAAA;AACAR,IAAAA,gBAAA,CAAAlB,aAAA,CAAA;AACAc,IAAAA,UAAA,CAAAyB,eAAA,CAAAxC,OAAA,CAAA2B,IAAA,CAAA,gBAAA,CAAA;AACA,GA9CA;AA+CA,CAnDA,CAAA","file":"FormElement.js","sourcesContent":["define([\n\t'jquery',\n\t'./AreaEditor'\n], ($, AreaEditor) => {\n\t$(document).ready(() => {\n\t\tlet $control = $('.imagemap-control:eq(0)'),\n\t\t\t$image = $control.find('.image img'),\n\t\t\t$canvas = $control.find('.picture'),\n\t\t\teditorOptions = {\n\t\t\t\tcanvas: {\n\t\t\t\t\twidth: parseInt($image.css('width')),\n\t\t\t\t\theight: parseInt($image.css('height')),\n\t\t\t\t\ttop: parseInt($image.css('height')) * -1,\n\t\t\t\t},\n\t\t\t\tpreviewRerenderAjaxUrl: window.TYPO3.settings.ajaxUrls.imagemap_preview_rerender\n\t\t\t},\n\t\t\tcanvasContainer = $control.find('#canvas')[0],\n\t\t\tareaEditor = new AreaEditor(editorOptions, canvasContainer, '', window.document);\n\n\t\tlet initializeScaleFactor = (scaleFactor) => {\n\t\t\tareaEditor.setScale(scaleFactor);\n\t\t};\n\n\t\tlet initializeEvents = (editorOptions) => {\n\t\t\t$control.find('input[type=hidden]').on('imagemap:changed', (event) => {\n\t\t\t\tlet $field = $(event.currentTarget);\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: editorOptions.previewRerenderAjaxUrl,\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tP: {\n\t\t\t\t\t\t\titemFormElName: $field.attr('name'),\n\t\t\t\t\t\t\ttableName: 'tt_content',\n\t\t\t\t\t\t\tfieldName: 'tx_imagemap_links',\n\t\t\t\t\t\t\tuid: $field.attr('name').replace('data[tt_content][', '').replace('][tx_imagemap_links]', ''),\n\t\t\t\t\t\t\tvalue: $field.val()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).done((data, textStatus) => {\n\t\t\t\t\tif (textStatus === 'success') {\n\t\t\t\t\t\tareaEditor.removeAllAreas();\n\t\t\t\t\t\tareaEditor.initializeAreas(data);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tinitializeScaleFactor($canvas.data('thumbnail-scale'));\n\t\tinitializeEvents(editorOptions);\n\t\tareaEditor.initializeAreas($canvas.data('existing-areas'));\n\t});\n});\n"]}