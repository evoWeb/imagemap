{"version":3,"sources":["FormElement.js"],"names":["define","$","document","ready","$control","$canvas","find","areaEditor","previewCanvasClass","init","attr","initializeScaleFactor","scaleFactor","setScale","initializeAreas","areas","forEach","area","addArea","window","shape","coords","alt","link","color","initializeEvents","on","$field","ajax","url","TYPO3","settings","ajaxUrls","method","data","P","itemFormElName","tableName","fieldName","uid","replace","value","val","done","textStatus","removeAreas"],"mappings":"AAAAA,MAAA,CAAA,CAAA,QAAA,EAAA,oBAAA,EAAA,qBAAA,EAAA,+BAAA,CAAA,EAAA,UAAAC,CAAA,EAAA;AACAA,EAAAA,CAAA,CAAAC,QAAA,CAAA,CAAAC,KAAA,CAAA,YAAA;AACA,QAAAC,QAAA,GAAAH,CAAA,CAAA,yBAAA,CAAA;AAAA,QACAI,OAAA,GAAAD,QAAA,CAAAE,IAAA,CAAA,SAAA,CADA;AAAA,QAEAC,UAAA,GAAA,IAAAC,kBAAA,EAFA;AAIAD,IAAAA,UAAA,CAAAE,IAAA,CAAAJ,OAAA,CAAAK,IAAA,CAAA,IAAA,CAAA;;AAEA,QAAAC,qBAAA,GAAA,SAAAA,qBAAA,CAAAC,WAAA,EAAA;AACAL,MAAAA,UAAA,CAAAM,QAAA,CAAAD,WAAA;AACA,KAFA;;AAIA,QAAAE,eAAA,GAAA,SAAAA,eAAA,CAAAC,KAAA,EAAA;AACAA,MAAAA,KAAA,CAAAC,OAAA,CAAA,UAAAC,IAAA,EAAA;AACAV,QAAAA,UAAA,CAAAW,OAAA,CACA,IAAAC,MAAA,CAAA,SAAAF,IAAA,CAAAG,KAAA,GAAA,OAAA,CAAA,EADA,EAEAH,IAAA,CAAAI,MAFA,EAGAJ,IAAA,CAAAK,GAHA,EAIAL,IAAA,CAAAM,IAJA,EAKAN,IAAA,CAAAO,KALA,EAMA,CANA;AAQA,OATA;AAUA,KAXA;;AAaA,QAAAC,gBAAA,GAAA,SAAAA,gBAAA,GAAA;AACArB,MAAAA,QAAA,CAAAE,IAAA,CAAA,OAAA,EAAAoB,EAAA,CAAA,kBAAA,EAAA,YAAA;AACA,YAAAC,MAAA,GAAA1B,CAAA,CAAA,IAAA,CAAA;AACAA,QAAAA,CAAA,CAAA2B,IAAA,CAAA;AACAC,UAAAA,GAAA,EAAAV,MAAA,CAAAW,KAAA,CAAAC,QAAA,CAAAC,QAAA,CAAA,2BAAA,CADA;AAEAC,UAAAA,MAAA,EAAA,MAFA;AAGAC,UAAAA,IAAA,EAAA;AACAC,YAAAA,CAAA,EAAA;AACAC,cAAAA,cAAA,EAAAT,MAAA,CAAAjB,IAAA,CAAA,MAAA,CADA;AAEA2B,cAAAA,SAAA,EAAA,YAFA;AAGAC,cAAAA,SAAA,EAAA,mBAHA;AAIAC,cAAAA,GAAA,EAAAZ,MAAA,CAAAjB,IAAA,CAAA,MAAA,EAAA8B,OAAA,CAAA,mBAAA,EAAA,EAAA,EAAAA,OAAA,CAAA,sBAAA,EAAA,EAAA,CAJA;AAKAC,cAAAA,KAAA,EAAAd,MAAA,CAAAe,GAAA;AALA;AADA;AAHA,SAAA,EAYAC,IAZA,CAYA,UAAAT,IAAA,EAAAU,UAAA,EAAA;AACA,cAAAA,UAAA,KAAA,SAAA,EAAA;AACArC,YAAAA,UAAA,CAAAsC,WAAA;AACAX,YAAAA,IAAA,CAAAlB,OAAA,CAAA,UAAAC,IAAA,EAAA;AACAV,cAAAA,UAAA,CAAAW,OAAA,CACA,IAAAC,MAAA,CAAA,SAAAF,IAAA,CAAAG,KAAA,GAAA,OAAA,CAAA,EADA,EAEAH,IAAA,CAAAI,MAFA,EAGAJ,IAAA,CAAAK,GAHA,EAIAL,IAAA,CAAAM,IAJA,EAKAN,IAAA,CAAAO,KALA,EAMA,CANA;AAQA,aATA;AAUA;AACA,SA1BA;AA2BA,OA7BA;AA8BA,KA/BA;;AAiCAb,IAAAA,qBAAA,CAAAN,OAAA,CAAA6B,IAAA,CAAA,iBAAA,CAAA,CAAA;AACApB,IAAAA,eAAA,CAAAT,OAAA,CAAA6B,IAAA,CAAA,gBAAA,CAAA,CAAA;AACAT,IAAAA,gBAAA;AACA,GA5DA;AA6DA,CA9DA,CAAA","file":"FormElement.js","sourcesContent":["define(['jquery', 'jquery-ui/sortable', 'jquery-ui/draggable', 'TYPO3/CMS/Imagemap/JsGraphics'], ($) => {\n\t$(document).ready(function () {\n\t\tlet $control = $('.imagemap-control:eq(0)'),\n\t\t\t$canvas = $control.find('.canvas'),\n\t\t\tareaEditor = new previewCanvasClass();\n\n\t\tareaEditor.init($canvas.attr('id'));\n\n\t\tlet initializeScaleFactor = (scaleFactor) => {\n\t\t\tareaEditor.setScale(scaleFactor);\n\t\t};\n\n\t\tlet initializeAreas = (areas) => {\n\t\t\tareas.forEach((area) => {\n\t\t\t\tareaEditor.addArea(\n\t\t\t\t\tnew window['area' + area.shape + 'Class'](),\n\t\t\t\t\tarea.coords,\n\t\t\t\t\tarea.alt,\n\t\t\t\t\tarea.link,\n\t\t\t\t\tarea.color,\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t});\n\t\t};\n\n\t\tlet initializeEvents = () => {\n\t\t\t$control.find('input').on('imagemap:changed', function () {\n\t\t\t\tlet $field = $(this);\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: window.TYPO3.settings.ajaxUrls['imagemap_preview_rerender'],\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tP: {\n\t\t\t\t\t\t\titemFormElName: $field.attr('name'),\n\t\t\t\t\t\t\ttableName: 'tt_content',\n\t\t\t\t\t\t\tfieldName: 'tx_imagemap_links',\n\t\t\t\t\t\t\tuid: $field.attr('name').replace('data[tt_content][', '').replace('][tx_imagemap_links]', ''),\n\t\t\t\t\t\t\tvalue: $field.val()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).done((data, textStatus) => {\n\t\t\t\t\tif (textStatus === 'success') {\n\t\t\t\t\t\tareaEditor.removeAreas();\n\t\t\t\t\t\tdata.forEach((area) => {\n\t\t\t\t\t\t\tareaEditor.addArea(\n\t\t\t\t\t\t\t\tnew window['area' + area.shape + 'Class'](),\n\t\t\t\t\t\t\t\tarea.coords,\n\t\t\t\t\t\t\t\tarea.alt,\n\t\t\t\t\t\t\t\tarea.link,\n\t\t\t\t\t\t\t\tarea.color,\n\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tinitializeScaleFactor($canvas.data('thumbnail-scale'));\n\t\tinitializeAreas($canvas.data('existing-areas'));\n\t\tinitializeEvents();\n\t});\n});\n"]}