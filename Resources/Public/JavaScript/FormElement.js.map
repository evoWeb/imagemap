{"version":3,"sources":["FormElement.es6"],"names":["define","$","AreaEditor","document","ready","$control","$canvas","find","$image","editorConfig","canvas","width","parseInt","css","height","top","preview","areaEditor","previewCanvasClass","init","attr","initializeScaleFactor","scaleFactor","setScale","initializeAreas","areas","forEach","area","addArea","window","shape","coords","alt","link","color","initializeEvents","on","$field","ajax","url","TYPO3","settings","ajaxUrls","method","data","P","itemFormElName","tableName","fieldName","uid","replace","value","val","done","textStatus","removeAreas"],"mappings":"AAAAA,MAAA,CAAA,CACA,QADA,EAEA,+BAFA,EAGA,oBAHA,EAIA,qBAJA,EAKA,+BALA,CAAA,EAMA,UAAAC,CAAA,EAAAC,UAAA,EAAA;AACAD,EAAAA,CAAA,CAAAE,QAAA,CAAA,CAAAC,KAAA,CAAA,YAAA;AACA,QAAAC,QAAA,GAAAJ,CAAA,CAAA,yBAAA,CAAA;AAAA,QACAK,OAAA,GAAAD,QAAA,CAAAE,IAAA,CAAA,SAAA,CADA;AAAA,QAEAC,MAAA,GAAAH,QAAA,CAAAE,IAAA,CAAA,mBAAA,CAFA;AAAA,QAGAE,YAAA,GAAA;AACAC,MAAAA,MAAA,EAAA;AACAC,QAAAA,KAAA,EAAAC,QAAA,CAAAJ,MAAA,CAAAK,GAAA,CAAA,OAAA,CAAA,CADA;AAEAC,QAAAA,MAAA,EAAAF,QAAA,CAAAJ,MAAA,CAAAK,GAAA,CAAA,QAAA,CAAA,CAFA;AAGAE,QAAAA,GAAA,EAAAH,QAAA,CAAAJ,MAAA,CAAAK,GAAA,CAAA,QAAA,CAAA,CAAA,GAAA,CAAA;AAHA,OADA;AAMAG,MAAAA,OAAA,EAAA;AANA,KAHA;AAAA,QAWAC,UAAA,GAAA,IAAAC,kBAAA,EAXA;AAaAD,IAAAA,UAAA,CAAAE,IAAA,CAAAb,OAAA,CAAAc,IAAA,CAAA,IAAA,CAAA;;AAEA,QAAAC,qBAAA,GAAA,SAAAA,qBAAA,CAAAC,WAAA,EAAA;AACAL,MAAAA,UAAA,CAAAM,QAAA,CAAAD,WAAA;AACA,KAFA;;AAIA,QAAAE,eAAA,GAAA,SAAAA,eAAA,CAAAC,KAAA,EAAA;AACAA,MAAAA,KAAA,CAAAC,OAAA,CAAA,UAAAC,IAAA,EAAA;AACAV,QAAAA,UAAA,CAAAW,OAAA,CACA,IAAAC,MAAA,CAAA,SAAAF,IAAA,CAAAG,KAAA,GAAA,OAAA,CAAA,EADA,EAEAH,IAAA,CAAAI,MAFA,EAGAJ,IAAA,CAAAK,GAHA,EAIAL,IAAA,CAAAM,IAJA,EAKAN,IAAA,CAAAO,KALA,EAMA,CANA;AAQA,OATA;AAUA,KAXA;;AAaA,QAAAC,gBAAA,GAAA,SAAAA,gBAAA,GAAA;AACA9B,MAAAA,QAAA,CAAAE,IAAA,CAAA,oBAAA,EAAA6B,EAAA,CAAA,kBAAA,EAAA,YAAA;AACA,YAAAC,MAAA,GAAApC,CAAA,CAAA,IAAA,CAAA;AACAA,QAAAA,CAAA,CAAAqC,IAAA,CAAA;AACAC,UAAAA,GAAA,EAAAV,MAAA,CAAAW,KAAA,CAAAC,QAAA,CAAAC,QAAA,CAAA,2BAAA,CADA;AAEAC,UAAAA,MAAA,EAAA,MAFA;AAGAC,UAAAA,IAAA,EAAA;AACAC,YAAAA,CAAA,EAAA;AACAC,cAAAA,cAAA,EAAAT,MAAA,CAAAjB,IAAA,CAAA,MAAA,CADA;AAEA2B,cAAAA,SAAA,EAAA,YAFA;AAGAC,cAAAA,SAAA,EAAA,mBAHA;AAIAC,cAAAA,GAAA,EAAAZ,MAAA,CAAAjB,IAAA,CAAA,MAAA,EAAA8B,OAAA,CAAA,mBAAA,EAAA,EAAA,EAAAA,OAAA,CAAA,sBAAA,EAAA,EAAA,CAJA;AAKAC,cAAAA,KAAA,EAAAd,MAAA,CAAAe,GAAA;AALA;AADA;AAHA,SAAA,EAYAC,IAZA,CAYA,UAAAT,IAAA,EAAAU,UAAA,EAAA;AACA,cAAAA,UAAA,KAAA,SAAA,EAAA;AACArC,YAAAA,UAAA,CAAAsC,WAAA;AACA/B,YAAAA,eAAA,CAAAoB,IAAA,CAAA;AACA;AACA,SAjBA;AAkBA,OApBA;AAqBA,KAtBA;;AAwBAvB,IAAAA,qBAAA,CAAAf,OAAA,CAAAsC,IAAA,CAAA,iBAAA,CAAA,CAAA;AACApB,IAAAA,eAAA,CAAAlB,OAAA,CAAAsC,IAAA,CAAA,gBAAA,CAAA,CAAA;AACAT,IAAAA,gBAAA;AACA,GA5DA;AA6DA,CApEA,CAAA","file":"FormElement.js","sourcesContent":["define([\n\t'jquery',\n\t'TYPO3/CMS/Imagemap/AreaEditor',\n\t'jquery-ui/sortable',\n\t'jquery-ui/draggable',\n\t'TYPO3/CMS/Imagemap/JsGraphics'\n], ($, AreaEditor) => {\n\t$(document).ready(() => {\n\t\tlet $control = $('.imagemap-control:eq(0)'),\n\t\t\t$canvas = $control.find('.canvas'),\n\t\t\t$image = $control.find('.image-embed-item'),\n\t\t\teditorConfig = {\n\t\t\t\tcanvas: {\n\t\t\t\t\twidth: parseInt($image.css('width')),\n\t\t\t\t\theight: parseInt($image.css('height')),\n\t\t\t\t\ttop: parseInt($image.css('height')) * -1,\n\t\t\t\t},\n\t\t\t\tpreview: true\n\t\t\t},\n\t\t\tareaEditor = new previewCanvasClass();\n\n\t\tareaEditor.init($canvas.attr('id'));\n\n\t\tlet initializeScaleFactor = (scaleFactor) => {\n\t\t\tareaEditor.setScale(scaleFactor);\n\t\t};\n\n\t\tlet initializeAreas = (areas) => {\n\t\t\tareas.forEach((area) => {\n\t\t\t\tareaEditor.addArea(\n\t\t\t\t\tnew window['area' + area.shape + 'Class'](),\n\t\t\t\t\tarea.coords,\n\t\t\t\t\tarea.alt,\n\t\t\t\t\tarea.link,\n\t\t\t\t\tarea.color,\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t});\n\t\t};\n\n\t\tlet initializeEvents = () => {\n\t\t\t$control.find('input[type=hidden]').on('imagemap:changed', function () {\n\t\t\t\tlet $field = $(this);\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: window.TYPO3.settings.ajaxUrls['imagemap_preview_rerender'],\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tP: {\n\t\t\t\t\t\t\titemFormElName: $field.attr('name'),\n\t\t\t\t\t\t\ttableName: 'tt_content',\n\t\t\t\t\t\t\tfieldName: 'tx_imagemap_links',\n\t\t\t\t\t\t\tuid: $field.attr('name').replace('data[tt_content][', '').replace('][tx_imagemap_links]', ''),\n\t\t\t\t\t\t\tvalue: $field.val()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).done((data, textStatus) => {\n\t\t\t\t\tif (textStatus === 'success') {\n\t\t\t\t\t\tareaEditor.removeAreas();\n\t\t\t\t\t\tinitializeAreas(data);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tinitializeScaleFactor($canvas.data('thumbnail-scale'));\n\t\tinitializeAreas($canvas.data('existing-areas'));\n\t\tinitializeEvents();\n\t});\n});\n"]}