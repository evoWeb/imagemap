{"version":3,"sources":["FormElement.es6"],"names":["define","$","AreaEditor","document","ready","scaleFactor","$control","$image","find","$canvas","editorOptions","canvas","width","parseInt","css","height","top","areaEditor","data","setScale","on","$field","_this","ajax","url","window","TYPO3","settings","ajaxUrls","method","P","itemFormElName","attr","tableName","fieldName","uid","replace","value","val","done","textStatus","removeAllAreas","initializeAreas"],"mappings":"eAAAA,OAAA,CACA,SACA,iCACA,SAAAC,EAAAC,GACAD,EAAAE,UAAAC,MAAA,WACA,IAYAC,EAZAC,EAAAL,EAAA,2BACAM,EAAAD,EAAAE,KAAA,cACAC,EAAAH,EAAAE,KAAA,YACAE,EAAA,CACAC,OAAA,CACAC,MAAAC,SAAAN,EAAAO,IAAA,UACAC,OAAAF,SAAAN,EAAAO,IAAA,WACAE,KAAA,EAAAH,SAAAN,EAAAO,IAAA,aAGAG,EAAA,IAAAf,EAAAQ,EAAA,UAEAL,EA4BAI,EAAAS,KAAA,mBA3BAD,EAAAE,SAAAd,GAIAC,EAAAE,KAAA,sBAAAY,GAAA,mBAAA,WACA,IAAAC,EAAApB,EAAAqB,OACArB,EAAAsB,KAAA,CACAC,IAAAC,OAAAC,MAAAC,SAAAC,SAAA,0BACAC,OAAA,OACAX,KAAA,CACAY,EAAA,CACAC,eAAAV,EAAAW,KAAA,QACAC,UAAA,aACAC,UAAA,oBACAC,IAAAd,EAAAW,KAAA,QAAAI,QAAA,oBAAA,IAAAA,QAAA,uBAAA,IACAC,MAAAhB,EAAAiB,UAGAC,KAAA,SAAArB,EAAAsB,GACA,YAAAA,IACAvB,EAAAwB,iBACAxB,EAAAyB,gBAAAxB,QAQAD,EAAAyB,gBAAAjC,EAAAS,KAAA","file":"FormElement.js","sourcesContent":["define([\n\t'jquery',\n\t'TYPO3/CMS/Imagemap/AreaEditor'\n], ($, AreaEditor) => {\n\t$(document).ready(() => {\n\t\tlet $control = $('.imagemap-control:eq(0)'),\n\t\t\t$image = $control.find('.image img'),\n\t\t\t$canvas = $control.find('.picture'),\n\t\t\teditorOptions = {\n\t\t\t\tcanvas: {\n\t\t\t\t\twidth: parseInt($image.css('width')),\n\t\t\t\t\theight: parseInt($image.css('height')),\n\t\t\t\t\ttop: parseInt($image.css('height')) * -1,\n\t\t\t\t}\n\t\t\t},\n\t\t\tareaEditor = new AreaEditor(editorOptions, 'canvas');\n\n\t\tlet initializeScaleFactor = (scaleFactor) => {\n\t\t\tareaEditor.setScale(scaleFactor);\n\t\t};\n\n\t\tlet initializeEvents = () => {\n\t\t\t$control.find('input[type=hidden]').on('imagemap:changed', () => {\n\t\t\t\tlet $field = $(this);\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: window.TYPO3.settings.ajaxUrls['imagemap_preview_rerender'],\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tP: {\n\t\t\t\t\t\t\titemFormElName: $field.attr('name'),\n\t\t\t\t\t\t\ttableName: 'tt_content',\n\t\t\t\t\t\t\tfieldName: 'tx_imagemap_links',\n\t\t\t\t\t\t\tuid: $field.attr('name').replace('data[tt_content][', '').replace('][tx_imagemap_links]', ''),\n\t\t\t\t\t\t\tvalue: $field.val()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).done((data, textStatus) => {\n\t\t\t\t\tif (textStatus === 'success') {\n\t\t\t\t\t\tareaEditor.removeAllAreas();\n\t\t\t\t\t\tareaEditor.initializeAreas(data);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tinitializeScaleFactor($canvas.data('thumbnail-scale'));\n\t\tinitializeEvents();\n\t\tareaEditor.initializeAreas($canvas.data('existing-areas'));\n\t});\n});\n"]}