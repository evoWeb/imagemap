{"version":3,"sources":["AreaEditor.es6"],"names":["define","$","fabric","Aggregation","baseClass","mixins","base","args","forEach","mixin","copyProperties","target","source","Object","getOwnPropertyNames","concat","getOwnPropertySymbols","property","match","defineProperty","getOwnPropertyDescriptor","prototype","AreaFormElement","id","__uid","hasOwnProperty","attributes","initializeElement","initializeColorPicker","updateFields","initializeEvents","element","getFormElement","constructor","name","toLowerCase","form","areaZone","appendChild","initializeArrows","colorPicker","getElement","values","b","g","r","color","cell","document","createElement","style","backgroundColor","classList","add","addEventListener","colorPickerAction","bind","that","on","getElements","field","event","clearTimeout","eventDelay","setTimeout","updateCanvas","button","firstChild","lastChild","currentTarget","contains","link","value","openLinkBrowser","moveArea","deleteArea","remove","showElement","hideElement","set","AreaEditor","hexToRgbA","rgbAToHex","editor","canvas","renderAll","selector","template","querySelector","innerHTML","replace","RegExp","DOMParser","parseFromString","body","querySelectorAll","getAreaCoords","getAdditionalAttributes","getLink","join","result","push","length","Rect","alt","Math","floor","left","top","getScaledWidth","getScaledHeight","entries","attribute","parseInt","width","height","Circle","getRadiusX","radius","Poly","points","point","index","append","x","y","split","control","controls","getCenterPoint","indexOf","setCoords","center","areaConfig","addControl","get","polygon","circle","hasControls","fill","cornerColor","stroke","cornerStrokeColor","originX","originY","type","pointMoved","currentTabId","firstPoint","lastPoint","parentNode","oldId","setAttribute","positionOptions","insertBefore","Polygon","AreaForm","formElement","areas","area","postAddToForm","currentArea","offset","newIndex","parent","removedArea","splice","childNodes","blur","data","window","imagemap","browseLink","objectId","itemName","currentValue","ajax","url","TYPO3","settings","ajaxUrls","context","done","response","vHWin","open","focus","xml","toAreaXml","options","cornerSize","cornerStyle","hasBorders","hasRotatingPoint","transparentCorners","initializeOptions","Canvas","selection","preview","option","scaling","scaleFactor","configuration","getRandomColor","coords","right","bottom","strokeWidth","addArea","setControlVisible","coordsXY","i","Error","xy","min","selectable","objectCaching","addControls","syncAreaLinkValue","undefined","random","toString","hex","alpha","chars","test","substring","rgba","numbers","rgb","slice","toUpperCase"],"mappings":"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","file":"AreaEditor.js","sourcesContent":["define(['jquery', 'TYPO3/CMS/Imagemap/Fabric'], ($, fabric) => {\n\tlet Aggregation = (baseClass, ...mixins) => {\n\t\tclass base extends baseClass {\n\t\t\tconstructor (...args) {\n\t\t\t\tsuper(...args);\n\t\t\t\tmixins.forEach((mixin) => {\n\t\t\t\t\tcopyProperties(this, (new mixin));\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// this function copies all properties and symbols, filtering out some special ones\n\t\tlet copyProperties = (target, source) => {\n\t\t\tObject.getOwnPropertyNames(source)\n\t\t\t\t.concat(Object.getOwnPropertySymbols(source))\n\t\t\t\t.forEach((property) => {\n\t\t\t\t\tif (!property.match(\n\t\t\t\t\t\t/^(?:constructor|prototype|arguments|caller|name|bind|call|apply|toString|length)$/\n\t\t\t\t\t)) {\n\t\t\t\t\t\tObject.defineProperty(target, property, Object.getOwnPropertyDescriptor(source, property));\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t};\n\n\t\t// outside constructor() to allow Aggregation(a, b, c).staticFunction() to be called etc.\n\t\tmixins.forEach((mixin) => {\n\t\t\tcopyProperties(base.prototype, mixin.prototype);\n\t\t\tcopyProperties(base, mixin);\n\t\t});\n\n\t\treturn base;\n\t};\n\n\tclass AreaFormElement {\n\t\t/**\n\t\t * @type {ChildNode|HTMLElement}\n\t\t */\n\t\telement = null;\n\n\t\t/**\n\t\t * @type {AreaForm}\n\t\t */\n\t\tform = null;\n\n\t\t/**\n\t\t * @type {number}\n\t\t */\n\t\teventDelay = 0;\n\n\t\tpostAddToForm() {\n\t\t\tthis.id = fabric.Object.__uid++;\n\n\t\t\tif (!this.hasOwnProperty('attributes')) {\n\t\t\t\tthis.attributes = [];\n\t\t\t}\n\n\t\t\tthis.initializeElement();\n\t\t\tthis.initializeColorPicker();\n\t\t\tthis.updateFields();\n\t\t\tthis.initializeEvents();\n\t\t}\n\n\t\tinitializeElement() {\n\t\t\tthis.element = this.getFormElement('#' + this.constructor.name.toLowerCase() + 'Form');\n\t\t\tthis.form.areaZone.appendChild(this.element);\n\t\t\tthis.form.initializeArrows();\n\t\t}\n\n\t\tinitializeColorPicker() {\n\t\t\tlet colorPicker = this.getElement('.colorPicker'),\n\t\t\t\tvalues = ['00', '33', '66', '99', 'CC', 'FF'];\n\n\t\t\tfor (let b = 1; b < 6; b++) {\n\t\t\t\tfor (let g = 1; g < 5; g++) {\n\t\t\t\t\tfor (let r = 1; r < 6; r++) {\n\t\t\t\t\t\tlet color = values[b] + values[g] + values[r],\n\t\t\t\t\t\t\tcell = document.createElement('div');\n\t\t\t\t\t\tcell.id = color;\n\t\t\t\t\t\tcell.style.backgroundColor = '#' + color;\n\t\t\t\t\t\tcell.classList.add('colorPickerCell');\n\t\t\t\t\t\tcell.addEventListener('click', this.colorPickerAction.bind(this));\n\n\t\t\t\t\t\tcolorPicker.appendChild(cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinitializeEvents() {\n\t\t\tlet that = this;\n\t\t\tthis.on('moved', this.updateFields.bind(this));\n\t\t\tthis.on('modified', this.updateFields.bind(this));\n\n\t\t\tthis.getElements('.positionOptions .t3js-field').forEach(function (field) {\n\t\t\t\tfield.addEventListener('keyup', function(event) {\n\t\t\t\t\tclearTimeout(that.eventDelay);\n\t\t\t\t\tthat.eventDelay = setTimeout(() => { that.updateCanvas(event); }, 500);\n\t\t\t\t}.bind(this));\n\t\t\t}.bind(this));\n\n\t\t\tthis.getElements('.basicOptions .t3js-field, .attributes .t3js-field').forEach(function (field) {\n\t\t\t\tfield.addEventListener('keyup', this['updateProperties'].bind(this));\n\t\t\t}.bind(this));\n\n\t\t\tthis.getElements('.t3js-btn').forEach(function (button) {\n\t\t\t\tbutton.addEventListener('click', this[button.id + 'Action'].bind(this));\n\t\t\t}.bind(this));\n\t\t}\n\n\t\tinitializeArrows() {\n\t\t\tlet areaZone = this.form.areaZone;\n\t\t\tthis.getElement('#up').classList[areaZone.firstChild !== this.element ? 'remove' : 'add']('disabled');\n\t\t\tthis.getElement('#down').classList[areaZone.lastChild !== this.element ? 'remove' : 'add']('disabled');\n\t\t}\n\n\t\tupdateFields() {\n\t\t}\n\n\t\tupdateProperties(event) {\n\t\t\tlet field = event.currentTarget;\n\t\t\tif (field.classList.contains('link')) {\n\t\t\t\tthis.link = field.value;\n\t\t\t} else if (this.hasOwnProperty(field.id)) {\n\t\t\t\tthis[field.id] = field.value;\n\t\t\t} else if (this.attributes.hasOwnProperty(field.id)) {\n\t\t\t\tthis.attributes[field.id] = field.value;\n\t\t\t}\n\t\t}\n\n\t\tupdateCanvas() {\n\t\t}\n\n\n\t\tlinkAction(event) {\n\t\t\tthis.form.openLinkBrowser(event.currentTarget, this);\n\t\t}\n\n\t\tupAction() {\n\t\t\tthis.form.moveArea(this, -1);\n\t\t}\n\n\t\tdownAction() {\n\t\t\tthis.form.moveArea(this, 1);\n\t\t}\n\n\t\tundoAction() {\n\t\t}\n\n\t\tredoAction() {\n\t\t}\n\n\t\tdeleteAction() {\n\t\t\tthis.form.deleteArea(this);\n\t\t\tthis.element.remove();\n\t\t\tthis.form.initializeArrows();\n\t\t\tdelete this;\n\t\t}\n\n\t\texpandAction() {\n\t\t\tthis.showElement('.moreOptions');\n\t\t\tthis.hideElement('#expand');\n\t\t\tthis.showElement('#collapse');\n\t\t}\n\n\t\tcollapseAction() {\n\t\t\tthis.hideElement('.moreOptions');\n\t\t\tthis.hideElement('#collapse');\n\t\t\tthis.showElement('#expand');\n\t\t}\n\n\t\tcolorPickerAction(event) {\n\t\t\tlet color = event.currentTarget.style.backgroundColor;\n\t\t\tthis.getElement('#color').style.backgroundColor = color;\n\t\t\tthis.set('borderColor', color);\n\t\t\tthis.set('stroke', color);\n\t\t\tthis.set('fill', AreaEditor.hexToRgbA(AreaEditor.rgbAToHex(color), 0.2));\n\t\t\tthis.form.editor.canvas.renderAll();\n\t\t}\n\n\n\t\tgetFormElement(selector, id) {\n\t\t\tlet template = this.form.element.querySelector(selector)\n\t\t\t\t.innerHTML.replace(new RegExp('_ID', 'g'), id ? id : this.id);\n\t\t\treturn new DOMParser().parseFromString(template, 'text/html').body.firstChild;\n\t\t}\n\n\t\tgetElement(selector) {\n\t\t\treturn this.element.querySelector(selector);\n\t\t}\n\n\t\tgetElements(selector) {\n\t\t\treturn this.element.querySelectorAll(selector);\n\t\t}\n\n\t\thideElement(selector) {\n\t\t\tthis.getElement(selector).classList.add('hide');\n\t\t}\n\n\t\tshowElement(selector) {\n\t\t\tthis.getElement(selector).classList.remove('hide');\n\t\t}\n\n\n\t\ttoAreaXml() {\n\t\t\treturn [\n\t\t\t\t'<area shape=\"' + this.constructor.name.toLowerCase() + '\"',\n\t\t\t\t' coords=\"' + this.getAreaCoords() + '\"',\n\t\t\t\tthis.getAdditionalAttributes() + '>',\n\t\t\t\tthis.getLink(),\n\t\t\t\t'</area>'\n\t\t\t].join('');\n\t\t}\n\n\t\tgetAreaCoords() {\n\t\t}\n\n\t\tgetAdditionalAttributes() {\n\t\t\tlet result = [];\n\n\t\t\tthis.getElements('.t3js-field').forEach((field) => {\n\t\t\t\tif (!field.classList.contains('ignored-attribute')) {\n\t\t\t\t\tswitch (field.id) {\n\t\t\t\t\t\tcase 'color':\n\t\t\t\t\t\t\tresult.push(field.id + '=\"' + AreaEditor.rgbAToHex(field.style.backgroundColor) + '\"');\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tresult.push(field.id + '=\"' + field.value + '\"');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn (result.length > 0 ? ' ' : '') + result.join(' ');\n\t\t}\n\n\t\tgetLink() {\n\t\t\treturn this.getElement('.link').value;\n\t\t}\n\t}\n\n\tclass Rect extends Aggregation(fabric.Rect, AreaFormElement) {\n\t\tupdateFields() {\n\t\t\tthis.getElement('#color').style.backgroundColor = this.color;\n\t\t\tthis.getElement('#alt').value = this.alt;\n\t\t\tthis.getElement('.link').value = this.link;\n\t\t\tthis.getElement('#left').value = Math.floor(this.left + 0);\n\t\t\tthis.getElement('#top').value = Math.floor(this.top + 0);\n\t\t\tthis.getElement('#right').value = Math.floor(this.left + this.getScaledWidth());\n\t\t\tthis.getElement('#bottom').value = Math.floor(this.top + this.getScaledHeight());\n\n\t\t\tObject.entries(this.attributes).forEach((attribute) => {\n\t\t\t\tthis.getElement('#' + attribute[0]).value = attribute[1];\n\t\t\t});\n\t\t}\n\n\t\tupdateCanvas(event) {\n\t\t\tlet field = event.currentTarget || event.target,\n\t\t\t\tvalue = 0;\n\n\t\t\tswitch (field.id) {\n\t\t\t\tcase 'left':\n\t\t\t\t\tvalue = parseInt(field.value);\n\t\t\t\t\tthis.getElement('#right').value = value + this.getScaledWidth();\n\t\t\t\t\tthis.set({left: value});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'top':\n\t\t\t\t\tvalue = parseInt(field.value);\n\t\t\t\t\tthis.getElement('#bottom').value = value + this.getScaledHeight();\n\t\t\t\t\tthis.set({top: value});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'right':\n\t\t\t\t\tvalue = field.value - this.left;\n\t\t\t\t\tif (value < 0) {\n\t\t\t\t\t\tvalue = 10;\n\t\t\t\t\t\tfield.value = this.left + value;\n\t\t\t\t\t}\n\t\t\t\t\tthis.set({width: value});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bottom':\n\t\t\t\t\tvalue = field.value - this.top;\n\t\t\t\t\tif (value < 0) {\n\t\t\t\t\t\tvalue = 10;\n\t\t\t\t\t\tfield.value = this.top + value;\n\t\t\t\t\t}\n\t\t\t\t\tthis.set({height: value});\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.canvas.renderAll();\n\t\t}\n\n\t\tgetAreaCoords() {\n\t\t\treturn [\n\t\t\t\tMath.floor(this.left + 0),\n\t\t\t\tMath.floor(this.top + 0),\n\t\t\t\tMath.floor(this.left + this.getScaledWidth()),\n\t\t\t\tMath.floor(this.top + this.getScaledHeight())\n\t\t\t].join(',');\n\t\t}\n\t}\n\n\tclass Circle extends Aggregation(fabric.Circle, AreaFormElement) {\n\t\tupdateFields() {\n\t\t\tthis.getElement('#color').style.backgroundColor = this.color;\n\t\t\tthis.getElement('#alt').value = this.alt;\n\t\t\tthis.getElement('.link').value = this.link;\n\t\t\tthis.getElement('#left').value = Math.floor(this.left + 0);\n\t\t\tthis.getElement('#top').value = Math.floor(this.top + 0);\n\t\t\tthis.getElement('#radius').value = Math.floor(this.getRadiusX());\n\n\t\t\tObject.entries(this.attributes).forEach((attribute) => {\n\t\t\t\tthis.getElement('#' + attribute[0]).value = attribute[1];\n\t\t\t});\n\t\t}\n\n\t\tupdateCanvas(event) {\n\t\t\tlet field = event.currentTarget || event.target,\n\t\t\t\tvalue = 0;\n\n\t\t\tswitch (field.id) {\n\t\t\t\tcase 'left':\n\t\t\t\t\tvalue = parseInt(field.value);\n\t\t\t\t\tthis.set({left: value});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'top':\n\t\t\t\t\tvalue = parseInt(field.value);\n\t\t\t\t\tthis.set({top: value});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'radius':\n\t\t\t\t\tvalue = parseInt(field.value);\n\t\t\t\t\tthis.set({radius: value});\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.canvas.renderAll();\n\t\t}\n\n\t\tgetAreaCoords() {\n\t\t\treturn [\n\t\t\t\tMath.floor(this.left + this.getRadiusX()),\n\t\t\t\tMath.floor(this.top + this.getRadiusX()),\n\t\t\t\tMath.floor(this.getRadiusX())\n\t\t\t].join(',');\n\t\t}\n\t}\n\n\tclass Poly extends Aggregation(fabric.Polygon, AreaFormElement) {\n\t\t/**\n\t\t * @type {Array}\n\t\t */\n\t\tcontrols = [];\n\n\t\tupdateFields() {\n\t\t\tthis.getElement('#color').style.backgroundColor = this.color;\n\t\t\tthis.getElement('#alt').value = this.alt;\n\t\t\tthis.getElement('.link').value = this.link;\n\n\t\t\tObject.entries(this.attributes).forEach((attribute) => {\n\t\t\t\tthis.getElement('#' + attribute[0]).value = attribute[1];\n\t\t\t});\n\n\t\t\tthis.points.forEach((point, index) => {\n\t\t\t\tpoint.id = point.id ? point.id : 'p' + this.id + '_' + index;\n\n\t\t\t\tif (!point.hasOwnProperty('element')) {\n\t\t\t\t\tpoint.element = this.getFormElement('#polyCoords', point.id);\n\t\t\t\t\tthis.append(point.element);\n\t\t\t\t}\n\n\t\t\t\tpoint.element.querySelector('#x' + point.id).value = point.x;\n\t\t\t\tpoint.element.querySelector('#y' + point.id).value = point.y;\n\t\t\t});\n\t\t}\n\n\t\tupdateCanvas(event) {\n\t\t\tlet field = event.currentTarget || event.target,\n\t\t\t\t[, point] = field.id.split('_'),\n\t\t\t\tcontrol = this.controls[parseInt(point)],\n\t\t\t\tx = control.getCenterPoint().x,\n\t\t\t\ty = control.getCenterPoint().y;\n\n\t\t\tif (field.id.indexOf('x') > -1) {\n\t\t\t\tx = parseInt(field.value);\n\t\t\t}\n\t\t\tif (field.id.indexOf('y') > -1) {\n\t\t\t\ty = parseInt(field.value);\n\t\t\t}\n\n\t\t\tcontrol.set('left', x);\n\t\t\tcontrol.set('top', y);\n\t\t\tcontrol.setCoords();\n\t\t\tthis.points[control.name] = {x: x, y: y};\n\t\t\tthis.canvas.renderAll();\n\t\t}\n\n\t\tgetAreaCoords() {\n\t\t\tlet result = [];\n\n\t\t\tthis.controls.forEach((control) => {\n\t\t\t\tlet center = control.getCenterPoint();\n\t\t\t\tresult.push(center.x);\n\t\t\t\tresult.push(center.y);\n\t\t\t});\n\n\t\t\treturn result.join(',');\n\t\t}\n\n\n\t\taddControls(areaConfig) {\n\t\t\tthis.points.forEach((point, index) => {\n\t\t\t\tthis.addControl(areaConfig, point, index);\n\t\t\t});\n\n\t\t\tthis.canvas.on('object:moving', (event) => {\n\t\t\t\tif (event.target.get('type') === 'control') {\n\t\t\t\t\tlet control = event.target,\n\t\t\t\t\t\tcenter = control.getCenterPoint();\n\t\t\t\t\tcontrol.polygon.points[control.name] = {\n\t\t\t\t\t\tx: center.x,\n\t\t\t\t\t\ty: center.y\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\taddControl(areaConfig, point, index) {\n\t\t\tlet circle = new fabric.Circle({\n\t\t\t\t...areaConfig,\n\t\t\t\thasControls: false,\n\t\t\t\tradius: 5,\n\t\t\t\tfill: areaConfig.cornerColor,\n\t\t\t\tstroke: areaConfig.cornerStrokeColor,\n\t\t\t\tleft: point.x,\n\t\t\t\ttop: point.y,\n\t\t\t\toriginX: 'center',\n\t\t\t\toriginY: 'center',\n\t\t\t\tname: index,\n\t\t\t\tpolygon: this,\n\t\t\t\ttype: 'control'\n\t\t\t});\n\t\t\tcircle.on('moved', this.pointMoved.bind(this));\n\t\t\tthis.controls[index] = circle;\n\t\t\tthis.canvas.add(circle);\n\t\t}\n\n\t\tpointMoved(event) {\n\t\t\tlet point = event.currentTabId || event.target,\n\t\t\t\tid = 'p' + point.polygon.id + '_' + point.name,\n\t\t\t\tcenter = point.getCenterPoint();\n\n\t\t\tthis.getElement('#x' + id).value = center.x;\n\t\t\tthis.getElement('#y' + id).value = center.y;\n\t\t}\n\n\t\taddPointAction() {\n\t\t\tlet index = this.points.length,\n\t\t\t\tfirstPoint = this.points[0],\n\t\t\t\tlastPoint = this.points[index - 1],\n\t\t\t\tid = 'p' + this.id + '_' + index,\n\t\t\t\telement = this.getFormElement('#polyCoords', id),\n\t\t\t\tpoint = {\n\t\t\t\t\tx: (firstPoint.x + lastPoint.x) / 2,\n\t\t\t\t\ty: (firstPoint.y + lastPoint.y) / 2,\n\t\t\t\t\tid: id,\n\t\t\t\t\telement: element\n\t\t\t\t};\n\n\t\t\telement.querySelectorAll('.t3js-btn').forEach(function (button) {\n\t\t\t\tbutton.addEventListener('click', this[button.id + 'Action'].bind(this));\n\t\t\t}.bind(this));\n\n\t\t\telement.querySelector('#x' + point.id).value = point.x;\n\t\t\telement.querySelector('#y' + point.id).value = point.y;\n\n\t\t\tthis.append(element);\n\n\t\t\tthis.points.push(point);\n\t\t\tthis.addControl(this.form.editor.areaConfig, point, index);\n\t\t}\n\n\t\tremoveAction(event) {\n\t\t\tif (this.points.length > 3) {\n\t\t\t\tlet element = event.currentTarget.parentNode.parentNode,\n\t\t\t\t\tpoints = [],\n\t\t\t\t\tcontrols = [];\n\n\t\t\t\tthis.points.forEach((point, index) => {\n\t\t\t\t\tif (element.id !== point.id) {\n\t\t\t\t\t\tpoints.push(point);\n\t\t\t\t\t\tcontrols.push(this.controls[index]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpoint.element.remove();\n\t\t\t\t\t\tthis.canvas.remove(this.controls[index]);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tpoints.forEach((point, index) => {\n\t\t\t\t\tlet oldId = point.id;\n\t\t\t\t\tpoint.id = 'p' + this.id + '_' + index;\n\t\t\t\t\tthis.getElement('#' + oldId).id = point.id;\n\t\t\t\t\tthis.getElement('#x' + oldId).id = 'x' + point.id;\n\t\t\t\t\tthis.getElement('#y' + oldId).id = 'y' + point.id;\n\t\t\t\t\tthis.getElement('[for=\"x' + oldId + '\"]').setAttribute('for', 'x' + point.id);\n\t\t\t\t\tthis.getElement('[for=\"y' + oldId + '\"]').setAttribute('for', 'y' + point.id);\n\t\t\t\t\tcontrols[index].name = index;\n\t\t\t\t});\n\n\t\t\t\tthis.points = points;\n\t\t\t\tthis.controls = controls;\n\t\t\t\tthis.canvas.renderAll();\n\t\t\t}\n\t\t}\n\n\t\tprepend(element) {\n\t\t\tlet positionOptions = this.getElement('.positionOptions');\n\t\t\tpositionOptions.insertBefore(element, positionOptions.firstChild);\n\t\t}\n\n\t\tappend(element) {\n\t\t\tlet positionOptions = this.getElement('.positionOptions');\n\t\t\tpositionOptions.insertBefore(element, positionOptions.lastChild);\n\t\t}\n\t}\n\n\tclass AreaForm {\n\t\t/**\n\t\t * @type {Array}\n\t\t */\n\t\tareas = [];\n\n\t\t/**\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tareaZone = null;\n\n\t\tconstructor(formElement, editor) {\n\t\t\tthis.element = fabric.document.querySelector(formElement);\n\t\t\tthis.areaZone = this.element.querySelector('#areaZone');\n\t\t\tthis.editor = editor;\n\t\t}\n\n\t\tinitializeArrows() {\n\t\t\tthis.areas.forEach((area) => {\n\t\t\t\tarea.initializeArrows();\n\t\t\t});\n\t\t}\n\n\t\taddArea(area) {\n\t\t\tthis.areas.push(area);\n\t\t\tarea.form = this;\n\t\t\tarea.postAddToForm();\n\t\t}\n\n\t\tdeleteArea(area) {\n\t\t\tlet areas = [];\n\t\t\tthis.areas.forEach((currentArea) => {\n\t\t\t\tif (area !== currentArea) {\n\t\t\t\t\tareas.push(currentArea);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.areas = areas;\n\t\t\tthis.editor.deleteArea(area);\n\t\t}\n\n\t\tmoveArea(area, offset) {\n\t\t\tlet index = this.areas.indexOf(area),\n\t\t\t\tnewIndex = index + offset,\n\t\t\t\tparent = area.element.parentNode;\n\n\t\t\tif (newIndex > -1 && newIndex < this.areas.length) {\n\t\t\t\tlet removedArea = this.areas.splice(index, 1)[0];\n\t\t\t\tthis.areas.splice(newIndex, 0, removedArea);\n\n\t\t\t\tparent.childNodes[index][offset < 0 ? 'after' : 'before'](parent.childNodes[newIndex]);\n\t\t\t}\n\n\t\t\tthis.initializeArrows();\n\t\t}\n\n\t\topenLinkBrowser(link, area) {\n\t\t\tlink.blur();\n\n\t\t\tlet data = {\n\t\t\t\t...window.imagemap.browseLink,\n\t\t\t\tobjectId: area.id,\n\t\t\t\titemName: 'link' + area.id,\n\t\t\t\tcurrentValue: area.getLink()\n\t\t\t};\n\n\t\t\t$.ajax({\n\t\t\t\turl: TYPO3.settings.ajaxUrls['imagemap_browselink_url'],\n\t\t\t\tcontext: area,\n\t\t\t\tdata: data\n\t\t\t}).done(function (response) {\n\t\t\t\tlet vHWin = window.open(\n\t\t\t\t\tresponse.url,\n\t\t\t\t\t'',\n\t\t\t\t\t'height=600,width=500,status=0,menubar=0,scrollbars=1'\n\t\t\t\t);\n\t\t\t\tvHWin.focus()\n\t\t\t});\n\t\t}\n\n\t\tsyncAreaLinkValue(id) {\n\t\t\tthis.areas.forEach((area) => {\n\t\t\t\tif (area.id === parseInt(id)) {\n\t\t\t\t\tarea.link = area.getElement('.link').value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\ttoAreaXml() {\n\t\t\tlet xml = ['<map>'];\n\t\t\tthis.areas.forEach((area) => {\n\t\t\t\txml.push(area.toAreaXml());\n\t\t\t});\n\t\t\txml.push('</map>');\n\t\t\treturn xml.join(\"\\n\");\n\t\t}\n\t}\n\n\tclass AreaEditor {\n\t\tareaConfig = {\n\t\t\tcornerColor: '#eee',\n\t\t\tcornerStrokeColor: '#bbb',\n\t\t\tcornerSize: 10,\n\t\t\tcornerStyle: 'circle',\n\t\t\thasBorders: false,\n\t\t\thasRotatingPoint: false,\n\t\t\ttransparentCorners: false\n\t\t};\n\n\t\tpreview = false;\n\n\t\tconstructor(canvas, form, options) {\n\t\t\tthis.initializeOptions(options);\n\n\t\t\tthis.canvas = new fabric.Canvas(canvas, {\n\t\t\t\t...options.canvas,\n\t\t\t\tselection: false\n\t\t\t});\n\t\t\tif (!this.preview) {\n\t\t\t\tthis.form = new AreaForm(form, this);\n\t\t\t}\n\t\t}\n\n\t\tinitializeOptions(options) {\n\t\t\tfor (let option in options) {\n\t\t\t\tif (options.hasOwnProperty(option)) {\n\t\t\t\t\tthis[option] = options[option];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinitializeScaling(scaling) {\n\t\t\tlet width = parseInt(scaling) / this.canvas.width,\n\t\t\t\theight = parseInt(scaling) / this.canvas.height;\n\t\t\treturn (width > height) ? height : width;\n\t\t}\n\t\tsetScale(scaling) {\n\t\t\tthis.scaleFactor = scaling > 1 ? 1 : scaling;\n\t\t}\n\t\tgetMaxWidth() {\n\t\t\treturn this.scaleFactor * this.canvas.width;\n\t\t}\n\t\tgetMaxHeight() {\n\t\t\treturn this.scaleFactor * this.canvas.height;\n\t\t}\n\n\t\taddRect(configuration) {\n\t\t\tconfiguration.color = AreaEditor.getRandomColor(configuration.color);\n\t\t\tlet [left, top, right, bottom] = configuration.coords.split(','),\n\t\t\t\tarea = new Rect({\n\t\t\t\t\t...configuration,\n\t\t\t\t\t...this.areaConfig,\n\t\t\t\t\thasControls: !this.preview,\n\t\t\t\t\tleft: parseInt(left),\n\t\t\t\t\ttop: parseInt(top),\n\t\t\t\t\twidth: right - left,\n\t\t\t\t\theight: bottom - top,\n\t\t\t\t\tstroke: configuration.color,\n\t\t\t\t\tstrokeWidth: 1,\n\t\t\t\t\tfill: AreaEditor.hexToRgbA(configuration.color, this.preview ? 0.001 : 0.2)\n\t\t\t\t});\n\n\t\t\tthis.canvas.add(area);\n\t\t\tif (this.form) {\n\t\t\t\tthis.form.addArea(area);\n\t\t\t}\n\t\t}\n\n\t\taddCircle(configuration) {\n\t\t\tconfiguration.color = AreaEditor.getRandomColor(configuration.color);\n\t\t\tlet [left, top, radius] = configuration.coords.split(','),\n\t\t\t\tarea = new Circle({\n\t\t\t\t\t...configuration,\n\t\t\t\t\t...this.areaConfig,\n\t\t\t\t\thasControls: !this.preview,\n\t\t\t\t\tleft: left - radius,\n\t\t\t\t\ttop: top - radius,\n\t\t\t\t\tradius: parseInt(radius),\n\t\t\t\t\tstroke: configuration.color,\n\t\t\t\t\tstrokeWidth: 1,\n\t\t\t\t\tfill: AreaEditor.hexToRgbA(configuration.color, this.preview ? 0.001 : 0.2)\n\t\t\t\t});\n\n\t\t\tarea.setControlVisible('ml', false);\n\t\t\tarea.setControlVisible('mt', false);\n\t\t\tarea.setControlVisible('mr', false);\n\t\t\tarea.setControlVisible('mb', false);\n\n\t\t\tthis.canvas.add(area);\n\t\t\tif (this.form) {\n\t\t\t\tthis.form.addArea(area);\n\t\t\t}\n\t\t}\n\n\t\taddPoly(configuration) {\n\t\t\tconfiguration.color = AreaEditor.getRandomColor(configuration.color);\n\t\t\tlet coordsXY = configuration.coords.split(','),\n\t\t\t\tleft = 100000,\n\t\t\t\ttop = 100000,\n\t\t\t\ti = 0,\n\t\t\t\tpoints = [];\n\n\t\t\tif (coordsXY.length % 2) {\n\t\t\t\tthrow new Error('Bad coords count');\n\t\t\t}\n\n\t\t\tfor (; i < coordsXY.length; i = i + 2) {\n\t\t\t\tlet xy = {x: parseInt(coordsXY[i]), y: parseInt(coordsXY[i + 1])};\n\t\t\t\tpoints.push(xy);\n\n\t\t\t\tleft = Math.min(left, xy.x);\n\t\t\t\ttop = Math.min(top, xy.y);\n\t\t\t}\n\n\t\t\tlet area = new Poly(points, {\n\t\t\t\t...configuration,\n\t\t\t\t...this.areaConfig,\n\t\t\t\tselectable: false,\n\t\t\t\tobjectCaching: false,\n\t\t\t\thasControls: !this.preview,\n\t\t\t\ttop: top,\n\t\t\t\tleft: left,\n\t\t\t\tstroke: configuration.color,\n\t\t\t\tstrokeWidth: 1,\n\t\t\t\tfill: AreaEditor.hexToRgbA(configuration.color, this.preview ? 0.001 : 0.2)\n\t\t\t});\n\n\t\t\tthis.canvas.add(area);\n\t\t\tif (this.form) {\n\t\t\t\tarea.addControls(this.areaConfig);\n\t\t\t\tthis.form.addArea(area);\n\t\t\t}\n\t\t}\n\n\t\ttriggerAreaLinkUpdate(id) {\n\t\t\tthis.form.syncAreaLinkValue(id);\n\t\t}\n\n\t\tdeleteArea(area) {\n\t\t\tthis.canvas.remove(area);\n\t\t}\n\n\t\ttoAreaXml() {\n\t\t\treturn this.form.toAreaXml();\n\t\t}\n\n\t\tstatic getRandomColor(color) {\n\t\t\tif (color === undefined) {\n\t\t\t\tlet r = (Math.floor(Math.random() * 5) * 3).toString(16),\n\t\t\t\t\tg = (Math.floor(Math.random() * 5) * 3).toString(16),\n\t\t\t\t\tb = (Math.floor(Math.random() * 5) * 3).toString(16);\n\t\t\t\tcolor = '#' + r + r + g + g + b + b;\n\t\t\t}\n\t\t\treturn color;\n\t\t}\n\n\t\tstatic hexToRgbA(hex, alpha) {\n\t\t\tlet chars, r, g, b, result;\n\t\t\tif (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\n\t\t\t\tchars = hex.substring(1).split('');\n\t\t\t\tif (chars.length === 3) {\n\t\t\t\t\tchars = [chars[0], chars[0], chars[1], chars[1], chars[2], chars[2]];\n\t\t\t\t}\n\n\t\t\t\tr = parseInt(chars[0] + chars[1], 16);\n\t\t\t\tg = parseInt(chars[2] + chars[3], 16);\n\t\t\t\tb = parseInt(chars[4] + chars[5], 16);\n\n\t\t\t\tif (alpha) {\n\t\t\t\t\tresult = 'rgba(' + [r, g, b, alpha].join(', ') + ')';\n\t\t\t\t} else {\n\t\t\t\t\tresult = 'rgb(' + [r, g, b].join(', ') + ')';\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\tthrow new Error('Bad Hex');\n\t\t}\n\n\t\tstatic rgbAToHex(rgba) {\n\t\t\tlet numbers = rgba.replace(/[^0-9,]*/g, '').split(',');\n\n\t\t\tif (numbers.length < 3) {\n\t\t\t\tthrow new Error('Bad rgba');\n\t\t\t}\n\n\t\t\tlet rgb = numbers[2] | (numbers[1] << 8) | (numbers[0] << 16);\n\t\t\treturn '#' + (0x1000000 + rgb).toString(16).slice(1).toUpperCase();\n\t\t}\n\t}\n\n\treturn AreaEditor;\n});\n"]}