{"version":3,"sources":["AreaEditor.es6"],"names":["define","$","fabric","d","top","document","w","window","Aggregation","baseClass","mixins","base","args","forEach","mixin","copyProperties","target","source","propertySymbols","Object","getOwnPropertySymbols","getOwnPropertyNames","concat","property","match","defineProperty","getOwnPropertyDescriptor","prototype","AreaFormElement","id","__uid","hasOwnProperty","attributes","initializeElement","updateFields","initializeColorPicker","initializeEvents","addFauxInput","element","getFormElement","name","form","areaZone","append","initializeArrows","getElement","minicolors","format","position","theme","changeDelay","change","colorPickerAction","bind","on","getElements","coordinateFieldHandler","attributeFieldHandler","buttonHandler","field","addEventListener","fieldKeyUpHandler","event","clearTimeout","eventDelay","wait","updateCanvas","updateProperties","button","classList","firstChild","lastChild","currentTarget","contains","link","value","openLinkBrowser","moveArea","remove","editor","deleteArea","removeFauxInput","showElement","hideElement","set","AreaEditor","hexToRgbA","canvas","renderAll","selector","template","querySelector","innerHTML","replace","RegExp","DOMParser","parseFromString","body","querySelectorAll","add","getAreaCoords","getAdditionalAttributes","getLink","join","result","push","length","fauxForm","fauxInput","fauxFormDocument","createElement","setAttribute","fauxInputChanged","appendChild","callback","delay","setTimeout","Rect","color","alt","Math","floor","left","getScaledWidth","getScaledHeight","entries","attribute","parseInt","width","height","Circle","getRadiusX","radius","Poly","points","options","coordsXY","coords","split","i","Error","xy","x","y","min","point","polygonMoved","parentElement","index","control","controls","getCenterPoint","indexOf","setCoords","center","addControl","controlConfig","areaConfig","newControlIndex","circle","hasControls","fill","cornerColor","stroke","cornerStrokeColor","originX","originY","polygon","type","opacity","pointMoved","addElementToArrayWithPosition","currentTabId","direction","before","getPointElementAndCurrentPoint","currentPointIndex","currentPoint","insertBefore","after","nextSibling","currentPointId","parentNode","getCurrentAndNextPoint","nextPoint","nextPointIndex","oldId","array","item","newPointIndex","unshift","newPoints","Polygon","AreaForm","formElement","addFauxFormForLinkBrowser","browseLink","removeFauxForm","areas","area","postAddToForm","offset","newIndex","parent","removedArea","splice","childNodes","blur","data","objectId","itemName","currentValue","ajax","url","browseLinkUrlAjaxUrl","context","done","response","vHWin","open","focus","formName","fauxFormContainer","removeChild","canvasSelector","formSelector","cornerSize","cornerStyle","hasBorders","hasRotatingPoint","transparentCorners","setOptions","preview","initializeCanvas","option","scaling","setZoom","getZoom","Canvas","selection","preserveObjectStacking","hoverCursor","activePolygon","deselected","selected","undefined","getRandomColor","configuration","selectable","strokeWidth","shape","addRect","addCircle","addPoly","addArea","deleteAction","right","bottom","setControlVisible","objectCaching","addControls","createEvent","initEvent","dispatchEvent","currentArea","xml","toAreaXml","r","random","toString","g","b","hex","alpha","chars","test","substring"],"mappings":"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","file":"AreaEditor.js","sourcesContent":["define([\n\t'jquery',\n\t'TYPO3/CMS/Imagemap/Fabric',\n\t'TYPO3/CMS/Core/Contrib/jquery.minicolors'\n], ($, fabric) => {\n\t// needed to access top frame elements\n\tlet d = top.document || document,\n\t\tw = top.window || window;\n\tif (typeof d !== 'undefined' && typeof w !== 'undefined') {\n\t\tfabric.document = d;\n\t\tfabric.window = w;\n\t}\n\n\tlet Aggregation = (baseClass, ...mixins) => {\n\t\tclass base extends baseClass {\n\t\t\tconstructor (...args) {\n\t\t\t\tsuper(...args);\n\t\t\t\tmixins.forEach((mixin) => {\n\t\t\t\t\tcopyProperties(this, (new mixin));\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// this function copies all properties and symbols, filtering out some special ones\n\t\tlet copyProperties = (target, source) => {\n\t\t\t/** @type {Array} */\n\t\t\tlet propertySymbols = Object.getOwnPropertySymbols(source);\n\t\t\tObject.getOwnPropertyNames(source)\n\t\t\t\t.concat(propertySymbols)\n\t\t\t\t.forEach((property) => {\n\t\t\t\t\tif (!property.match(\n\t\t\t\t\t\t/^(?:constructor|prototype|arguments|caller|name|bind|call|apply|toString|length)$/\n\t\t\t\t\t)) {\n\t\t\t\t\t\tObject.defineProperty(target, property, Object.getOwnPropertyDescriptor(source, property));\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t};\n\n\t\t// outside constructor() to allow Aggregation(a, b, c).staticFunction() to be called etc.\n\t\tmixins.forEach((mixin) => {\n\t\t\tcopyProperties(base.prototype, mixin.prototype);\n\t\t\tcopyProperties(base, mixin);\n\t\t});\n\n\t\treturn base;\n\t};\n\n\tclass AreaFormElement extends fabric.Object {\n\t\t/**\n\t\t * @type {string}\n\t\t */\n\t\tname = '';\n\n\t\t/**\n\t\t * @type {ChildNode|HTMLElement}\n\t\t */\n\t\telement = null;\n\n\t\t/**\n\t\t * @type {AreaForm}\n\t\t */\n\t\tform = null;\n\n\t\t/**\n\t\t * @type {number}\n\t\t */\n\t\teventDelay = 0;\n\n\t\t/**\n\t\t * @type {number}\n\t\t */\n\t\tstatic before = -1;\n\n\t\t/**\n\t\t * @type {number}\n\t\t */\n\t\tstatic after = 1;\n\n\t\tpostAddToForm() {\n\t\t\tthis.id = fabric.Object.__uid++;\n\n\t\t\tif (!this.hasOwnProperty('attributes')) {\n\t\t\t\tthis.attributes = [];\n\t\t\t}\n\n\t\t\tthis.initializeElement();\n\t\t\tthis.updateFields();\n\t\t\tthis.initializeColorPicker();\n\t\t\tthis.initializeEvents();\n\t\t\tthis.addFauxInput();\n\t\t}\n\n\t\tinitializeElement() {\n\t\t\tthis.element = this.getFormElement('#' + this.name + 'Form');\n\t\t\tthis.form.areaZone.append(this.element);\n\t\t\tthis.form.initializeArrows();\n\t\t}\n\n\t\tinitializeColorPicker() {\n\t\t\t$(this.getElement('.t3js-color-picker')).minicolors({\n\t\t\t\tformat: 'hex',\n\t\t\t\tposition: 'left',\n\t\t\t\ttheme: 'default',\n\t\t\t\tchangeDelay: 100,\n\t\t\t\tchange: this.colorPickerAction.bind(this)\n\t\t\t});\n\t\t}\n\n\t\tinitializeEvents() {\n\t\t\tthis.on('moved', this.updateFields.bind(this));\n\t\t\tthis.on('modified', this.updateFields.bind(this));\n\n\t\t\tthis.getElements('.positionOptions .t3js-field').forEach(this.coordinateFieldHandler.bind(this));\n\t\t\tthis.getElements('.basicOptions .t3js-field, .attributes .t3js-field').forEach(this.attributeFieldHandler.bind(this));\n\t\t\tthis.getElements('.t3js-btn').forEach(this.buttonHandler.bind(this));\n\t\t}\n\n\t\tcoordinateFieldHandler(field) {\n\t\t\tfield.addEventListener('keyup', this.fieldKeyUpHandler.bind(this));\n\t\t}\n\n\t\tfieldKeyUpHandler(event) {\n\t\t\tclearTimeout(this.eventDelay);\n\t\t\tthis.eventDelay = AreaFormElement.wait(() => { this.updateCanvas(event); }, 500);\n\t\t}\n\n\t\tattributeFieldHandler(field) {\n\t\t\tfield.addEventListener('keyup', this.updateProperties.bind(this));\n\t\t}\n\n\t\tbuttonHandler(button) {\n\t\t\tbutton.addEventListener('click', this[button.id + 'Action'].bind(this));\n\t\t}\n\n\t\tinitializeArrows() {\n\t\t\tlet areaZone = this.form.areaZone;\n\t\t\tthis.getElement('#up').classList[areaZone.firstChild !== this.element ? 'remove' : 'add']('disabled');\n\t\t\tthis.getElement('#down').classList[areaZone.lastChild !== this.element ? 'remove' : 'add']('disabled');\n\t\t}\n\n\t\tupdateFields() {\n\t\t}\n\n\t\tupdateProperties(event) {\n\t\t\tlet field = event.currentTarget;\n\t\t\tif (field.classList.contains('link')) {\n\t\t\t\tthis.link = field.value;\n\t\t\t} else if (this.hasOwnProperty(field.id)) {\n\t\t\t\tthis[field.id] = field.value;\n\t\t\t} else if (this.attributes.hasOwnProperty(field.id)) {\n\t\t\t\tthis.attributes[field.id] = field.value;\n\t\t\t}\n\t\t}\n\n\t\tupdateCanvas() {\n\t\t}\n\n\n\t\tlinkAction(event) {\n\t\t\tthis.form.openLinkBrowser(event.currentTarget, this);\n\t\t}\n\n\t\tupAction() {\n\t\t\tthis.form.moveArea(this, -1);\n\t\t}\n\n\t\tdownAction() {\n\t\t\tthis.form.moveArea(this, 1);\n\t\t}\n\n\t\tundoAction() {\n\t\t}\n\n\t\tredoAction() {\n\t\t}\n\n\t\tdeleteAction() {\n\t\t\tif (this.element) {\n\t\t\t\tthis.element.remove();\n\t\t\t}\n\t\t\tif (this.form) {\n\t\t\t\tthis.form.initializeArrows();\n\t\t\t}\n\t\t\tthis.editor.deleteArea(this);\n\t\t\tthis.removeFauxInput();\n\t\t\tdelete this;\n\t\t}\n\n\t\texpandAction() {\n\t\t\tthis.showElement('.moreOptions');\n\t\t\tthis.hideElement('#expand');\n\t\t\tthis.showElement('#collapse');\n\t\t}\n\n\t\tcollapseAction() {\n\t\t\tthis.hideElement('.moreOptions');\n\t\t\tthis.hideElement('#collapse');\n\t\t\tthis.showElement('#expand');\n\t\t}\n\n\t\tcolorPickerAction(value) {\n\t\t\tthis.getElement('.t3js-color-picker').value = value;\n\t\t\tthis.set('borderColor', value);\n\t\t\tthis.set('stroke', value);\n\t\t\tthis.set('fill', AreaEditor.hexToRgbA(value, 0.2));\n\t\t\tthis.editor.canvas.renderAll();\n\t\t}\n\n\n\t\tgetFormElement(selector, id) {\n\t\t\tlet template = this.form.element.querySelector(selector)\n\t\t\t\t.innerHTML.replace(new RegExp('_ID', 'g'), id ? id : this.id);\n\t\t\treturn new DOMParser().parseFromString(template, 'text/html').body.firstChild;\n\t\t}\n\n\t\tgetElement(selector) {\n\t\t\treturn this.element.querySelector(selector);\n\t\t}\n\n\t\tgetElements(selector) {\n\t\t\treturn this.element.querySelectorAll(selector);\n\t\t}\n\n\t\thideElement(selector) {\n\t\t\tthis.getElement(selector).classList.add('hide');\n\t\t}\n\n\t\tshowElement(selector) {\n\t\t\tthis.getElement(selector).classList.remove('hide');\n\t\t}\n\n\n\t\ttoAreaXml() {\n\t\t\treturn [\n\t\t\t\t'<area shape=\"' + this.name + '\"',\n\t\t\t\t' coords=\"' + this.getAreaCoords() + '\"',\n\t\t\t\tthis.getAdditionalAttributes() + '>',\n\t\t\t\tthis.getLink(),\n\t\t\t\t'</area>'\n\t\t\t].join('');\n\t\t}\n\n\t\tgetAreaCoords() {\n\t\t}\n\n\t\tgetAdditionalAttributes() {\n\t\t\tlet result = [];\n\n\t\t\tthis.getElements('.t3js-field').forEach((field) => {\n\t\t\t\tif (!field.classList.contains('ignored-attribute')) {\n\t\t\t\t\tresult.push(field.id + '=\"' + field.value + '\"');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn (result.length > 0 ? ' ' : '') + result.join(' ');\n\t\t}\n\n\t\tgetLink() {\n\t\t\treturn this.getElement('.link').value;\n\t\t}\n\n\t\t/**\n\t\t * Add faux input as target for browselink which listens for changes and writes value to real field\n\t\t */\n\t\taddFauxInput() {\n\t\t\tif (this.form.fauxForm !== null) {\n\t\t\t\tlet fauxInput = this.editor.fauxFormDocument.createElement('input');\n\t\t\t\tfauxInput.setAttribute('id', 'link' + this.id);\n\t\t\t\tfauxInput.setAttribute('data-formengine-input-name', 'link' + this.id);\n\t\t\t\tfauxInput.setAttribute('value', this.link);\n\t\t\t\tfauxInput.addEventListener('change', this.fauxInputChanged.bind(this));\n\t\t\t\tthis.form.fauxForm.appendChild(fauxInput);\n\t\t\t}\n\t\t}\n\n\t\tfauxInputChanged(event) {\n\t\t\tlet field = event.currentTarget;\n\t\t\tthis.link = field.value;\n\t\t\tthis.updateFields();\n\t\t}\n\n\t\tremoveFauxInput() {\n\t\t\tif (this.form && this.form.fauxForm !== null) {\n\t\t\t\tlet field = this.form.fauxForm.querySelector('#link' + this.id);\n\t\t\t\tif (field) {\n\t\t\t\t\tfield.remove();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstatic wait(callback, delay) {\n\t\t\treturn window.setTimeout(callback, delay);\n\t\t}\n\t}\n\n\tclass Rect extends Aggregation(fabric.Rect, AreaFormElement) {\n\t\tname = 'rect';\n\n\t\tupdateFields() {\n\t\t\tthis.getElement('#color').value = this.color;\n\t\t\tthis.getElement('#alt').value = this.alt || '';\n\t\t\tthis.getElement('.link').value = this.link || '';\n\t\t\tthis.getElement('#left').value = Math.floor(this.left + 0);\n\t\t\tthis.getElement('#top').value = Math.floor(this.top + 0);\n\t\t\tthis.getElement('#right').value = Math.floor(this.left + this.getScaledWidth());\n\t\t\tthis.getElement('#bottom').value = Math.floor(this.top + this.getScaledHeight());\n\n\t\t\tObject.entries(this.attributes).forEach((attribute) => {\n\t\t\t\tthis.getElement('#' + attribute[0]).value = attribute[1] || '';\n\t\t\t});\n\t\t}\n\n\t\tupdateCanvas(event) {\n\t\t\tlet field = event.currentTarget || event.target,\n\t\t\t\tvalue = 0;\n\n\t\t\tswitch (field.id) {\n\t\t\t\tcase 'left':\n\t\t\t\t\tvalue = parseInt(field.value);\n\t\t\t\t\tthis.getElement('#right').value = value + this.getScaledWidth();\n\t\t\t\t\tthis.set({left: value});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'top':\n\t\t\t\t\tvalue = parseInt(field.value);\n\t\t\t\t\tthis.getElement('#bottom').value = value + this.getScaledHeight();\n\t\t\t\t\tthis.set({top: value});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'right':\n\t\t\t\t\tvalue = field.value - this.left;\n\t\t\t\t\tif (value < 0) {\n\t\t\t\t\t\tvalue = 10;\n\t\t\t\t\t\tfield.value = this.left + value;\n\t\t\t\t\t}\n\t\t\t\t\tthis.set({width: value});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bottom':\n\t\t\t\t\tvalue = field.value - this.top;\n\t\t\t\t\tif (value < 0) {\n\t\t\t\t\t\tvalue = 10;\n\t\t\t\t\t\tfield.value = this.top + value;\n\t\t\t\t\t}\n\t\t\t\t\tthis.set({height: value});\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.canvas.renderAll();\n\t\t}\n\n\t\tgetAreaCoords() {\n\t\t\treturn [\n\t\t\t\tMath.floor(this.left + 0),\n\t\t\t\tMath.floor(this.top + 0),\n\t\t\t\tMath.floor(this.left + this.getScaledWidth() - 1),\n\t\t\t\tMath.floor(this.top + this.getScaledHeight() - 1)\n\t\t\t].join(',');\n\t\t}\n\t}\n\n\tclass Circle extends Aggregation(fabric.Circle, AreaFormElement) {\n\t\tname = 'circle';\n\n\t\tupdateFields() {\n\t\t\tthis.getElement('#color').value = this.color;\n\t\t\tthis.getElement('#alt').value = this.alt || '';\n\t\t\tthis.getElement('.link').value = this.link || '';\n\t\t\tthis.getElement('#left').value = Math.floor(this.left + 0);\n\t\t\tthis.getElement('#top').value = Math.floor(this.top + 0);\n\t\t\tthis.getElement('#radius').value = Math.floor(this.getRadiusX());\n\n\t\t\tObject.entries(this.attributes).forEach((attribute) => {\n\t\t\t\tthis.getElement('#' + attribute[0]).value = attribute[1] || '';\n\t\t\t});\n\t\t}\n\n\t\tupdateCanvas(event) {\n\t\t\tlet field = event.currentTarget || event.target,\n\t\t\t\tvalue = 0;\n\n\t\t\tswitch (field.id) {\n\t\t\t\tcase 'left':\n\t\t\t\t\tvalue = parseInt(field.value);\n\t\t\t\t\tthis.set({left: value});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'top':\n\t\t\t\t\tvalue = parseInt(field.value);\n\t\t\t\t\tthis.set({top: value});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'radius':\n\t\t\t\t\tvalue = parseInt(field.value);\n\t\t\t\t\tthis.set({radius: value});\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.canvas.renderAll();\n\t\t}\n\n\t\tgetAreaCoords() {\n\t\t\treturn [\n\t\t\t\tMath.floor(this.left + this.getRadiusX()),\n\t\t\t\tMath.floor(this.top + this.getRadiusX()),\n\t\t\t\tMath.floor(this.getRadiusX())\n\t\t\t].join(',');\n\t\t}\n\t}\n\n\tclass Poly extends Aggregation(fabric.Polygon, AreaFormElement) {\n\t\tname = 'poly';\n\n\t\tconstructor(points, options) {\n\t\t\tlet coordsXY = options.coords.split(','),\n\t\t\t\tleft = 100000,\n\t\t\t\ttop = 100000,\n\t\t\t\ti = 0;\n\n\t\t\tif (coordsXY.length % 2) {\n\t\t\t\tthrow new Error('Bad coords count');\n\t\t\t}\n\n\t\t\t// first get all coordinates and create point of odd even numbers\n\t\t\t// and get top and left corner of polygon\n\t\t\tpoints = [];\n\t\t\tfor (; i < coordsXY.length; i = i + 2) {\n\t\t\t\tlet xy = {\n\t\t\t\t\tx: parseInt(coordsXY[i]),\n\t\t\t\t\ty: parseInt(coordsXY[i + 1])\n\t\t\t\t};\n\t\t\t\tpoints.push(xy);\n\n\t\t\t\tleft = Math.min(left, xy.x);\n\t\t\t\ttop = Math.min(top, xy.y);\n\t\t\t}\n\t\t\toptions.left = left;\n\t\t\toptions.top = top;\n\n\t\t\t// reduce point x/y values by top/left values\n\t\t\tpoints.forEach((point) => {\n\t\t\t\tpoint.x = point.x - options.left;\n\t\t\t\tpoint.y = point.y - options.top;\n\t\t\t});\n\n\t\t\tsuper(points, options);\n\t\t\tthis.on('moved', this.polygonMoved.bind(this));\n\t\t}\n\n\t\tupdateFields() {\n\t\t\tthis.getElement('#color').value = this.color;\n\t\t\tthis.getElement('#alt').value = this.alt || '';\n\t\t\tthis.getElement('.link').value = this.link || '';\n\n\t\t\tObject.entries(this.attributes).forEach((attribute) => {\n\t\t\t\tthis.getElement('#' + attribute[0]).value = attribute[1] || '';\n\t\t\t});\n\n\t\t\tlet parentElement = this.getElement('.positionOptions');\n\t\t\tthis.points.forEach((point, index) => {\n\t\t\t\tpoint.id = point.id ? point.id : 'p' + this.id + '_' + index;\n\n\t\t\t\tif (!point.hasOwnProperty('element')) {\n\t\t\t\t\tpoint.element = this.getFormElement('#polyCoords', point.id);\n\t\t\t\t\tparentElement.append(point.element);\n\t\t\t\t}\n\n\t\t\t\tpoint.element.querySelector('#x' + point.id).value = point.x + this.left;\n\t\t\t\tpoint.element.querySelector('#y' + point.id).value = point.y + this.top;\n\t\t\t});\n\t\t}\n\n\t\tupdateCanvas(event) {\n\t\t\tlet field = event.currentTarget || event.target,\n\t\t\t\t[, point] = field.id.split('_'),\n\t\t\t\tcontrol = this.controls[parseInt(point)],\n\t\t\t\tx = control.getCenterPoint().x,\n\t\t\t\ty = control.getCenterPoint().y;\n\n\t\t\tif (field.id.indexOf('x') > -1) {\n\t\t\t\tx = parseInt(field.value);\n\t\t\t}\n\t\t\tif (field.id.indexOf('y') > -1) {\n\t\t\t\ty = parseInt(field.value);\n\t\t\t}\n\n\t\t\tcontrol.set('left', x);\n\t\t\tcontrol.set('top', y);\n\t\t\tcontrol.setCoords();\n\t\t\tthis.points[control.name] = {x: x, y: y};\n\t\t\tthis.canvas.renderAll();\n\t\t}\n\n\t\tgetAreaCoords() {\n\t\t\tlet result = [];\n\n\t\t\tthis.controls.forEach((control) => {\n\t\t\t\tlet center = control.getCenterPoint();\n\t\t\t\tresult.push(center.x);\n\t\t\t\tresult.push(center.y);\n\t\t\t});\n\n\t\t\treturn result.join(',');\n\t\t}\n\n\t\t/**\n\t\t * @type {Array}\n\t\t */\n\t\tcontrols = [];\n\n\t\taddControls() {\n\t\t\tthis.points.forEach((point, index) => {\n\t\t\t\tthis.addControl(this.controlConfig, point, index, 100000);\n\t\t\t});\n\t\t}\n\n\t\taddControl(areaConfig, point, index, newControlIndex) {\n\t\t\tlet circle = new fabric.Circle({\n\t\t\t\t...areaConfig,\n\t\t\t\thasControls: false,\n\t\t\t\tradius: 5,\n\t\t\t\tfill: areaConfig.cornerColor,\n\t\t\t\tstroke: areaConfig.cornerStrokeColor,\n\t\t\t\toriginX: 'center',\n\t\t\t\toriginY: 'center',\n\t\t\t\tname: index,\n\t\t\t\tpolygon: this,\n\t\t\t\tpoint: point,\n\t\t\t\ttype: 'control',\n\t\t\t\topacity: this.controls.length === 0 ? 0 : this.controls[0].opacity,\n\n\t\t\t\t// set control position relative to polygon\n\t\t\t\tleft: this.left + point.x,\n\t\t\t\ttop: this.top + point.y,\n\t\t\t});\n\t\t\tcircle.on('moved', this.pointMoved.bind(this));\n\n\t\t\tpoint.control = circle;\n\n\t\t\tthis.controls = Poly.addElementToArrayWithPosition(this.controls, circle, newControlIndex);\n\t\t\tthis.canvas.add(circle);\n\t\t\tthis.canvas.renderAll();\n\t\t}\n\n\t\tpointMoved(event) {\n\t\t\tlet control = event.currentTabId || event.target,\n\t\t\t\tid = 'p' + control.polygon.id + '_' + control.name,\n\t\t\t\tcenter = control.getCenterPoint();\n\n\t\t\tthis.getElement('#x' + id).value = center.x;\n\t\t\tthis.getElement('#y' + id).value = center.y;\n\t\t}\n\n\t\tpolygonMoved() {\n\t\t\tthis.points.forEach((point) => {\n\t\t\t\tthis.getElement('#x' + point.id).value = this.left + point.x;\n\t\t\t\tthis.getElement('#y' + point.id).value = this.top + point.y;\n\t\t\t});\n\t\t}\n\n\t\taddPointBeforeAction(event) {\n\t\t\tlet direction = AreaFormElement.before,\n\t\t\t\tindex = this.points.length,\n\t\t\t\tparentElement = this.getElement('.positionOptions'),\n\t\t\t\t[point, element, currentPointIndex, currentPoint] = this.getPointElementAndCurrentPoint(event, direction);\n\n\t\t\tparentElement.insertBefore(element, currentPoint.element);\n\n\t\t\tthis.points = Poly.addElementToArrayWithPosition(this.points, point, currentPointIndex + direction);\n\t\t\tthis.addControl(this.editor.areaConfig, point, index, currentPointIndex + direction);\n\t\t}\n\n\t\taddPointAfterAction(event) {\n\t\t\tlet direction = AreaFormElement.after,\n\t\t\t\tindex = this.points.length,\n\t\t\t\tparentElement = this.getElement('.positionOptions'),\n\t\t\t\t[point, element, currentPointIndex, currentPoint] = this.getPointElementAndCurrentPoint(event, direction);\n\n\t\t\tif (currentPoint.element.nextSibling) {\n\t\t\t\tparentElement.insertBefore(element, currentPoint.element.nextSibling);\n\t\t\t} else {\n\t\t\t\tparentElement.append(element);\n\t\t\t}\n\n\t\t\tthis.points = Poly.addElementToArrayWithPosition(this.points, point, currentPointIndex + direction);\n\t\t\tthis.addControl(this.editor.areaConfig, point, index, currentPointIndex + direction);\n\t\t}\n\n\t\tgetPointElementAndCurrentPoint(event, direction) {\n\t\t\tlet currentPointId = event.currentTarget.parentNode.parentNode.id,\n\t\t\t\t[currentPoint, nextPoint, currentPointIndex] = this.getCurrentAndNextPoint(currentPointId, direction),\n\t\t\t\tindex = this.points.length,\n\t\t\t\tid = 'p' + this.id + '_' + index,\n\t\t\t\telement = this.getFormElement('#polyCoords', id),\n\t\t\t\tpoint = {\n\t\t\t\t\tx: Math.floor((currentPoint.x + nextPoint.x) / 2),\n\t\t\t\t\ty: Math.floor((currentPoint.y + nextPoint.y) / 2),\n\t\t\t\t\tid: id,\n\t\t\t\t\telement: element\n\t\t\t\t};\n\n\t\t\telement.querySelectorAll('.t3js-btn').forEach(this.buttonHandler.bind(this));\n\n\t\t\telement.querySelector('#x' + point.id).value = point.x;\n\t\t\telement.querySelector('#y' + point.id).value = point.y;\n\n\t\t\treturn [point, element, currentPointIndex, currentPoint];\n\t\t}\n\n\t\tgetCurrentAndNextPoint(currentPointId, direction) {\n\t\t\tlet currentPointIndex = 0;\n\n\t\t\tfor (let i = 0; i < this.points.length; i++) {\n\t\t\t\tif (this.points[i].id === currentPointId) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcurrentPointIndex++;\n\t\t\t}\n\n\t\t\tlet nextPointIndex = currentPointIndex + direction;\n\n\t\t\tif (nextPointIndex < 0) {\n\t\t\t\tnextPointIndex = this.points.length - 1;\n\t\t\t}\n\t\t\tif (nextPointIndex >= this.points.length) {\n\t\t\t\tnextPointIndex = 0;\n\t\t\t}\n\n\t\t\treturn [this.points[currentPointIndex], this.points[nextPointIndex], currentPointIndex, nextPointIndex];\n\t\t}\n\n\t\tremovePointAction(event) {\n\t\t\tif (this.points.length > 3) {\n\t\t\t\tlet element = event.currentTarget.parentNode.parentNode,\n\t\t\t\t\tpoints = [],\n\t\t\t\t\tcontrols = [];\n\n\t\t\t\tthis.points.forEach((point, index) => {\n\t\t\t\t\tif (element.id !== point.id) {\n\t\t\t\t\t\tpoints.push(point);\n\t\t\t\t\t\tcontrols.push(this.controls[index]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpoint.element.remove();\n\t\t\t\t\t\tthis.canvas.remove(this.controls[index]);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tpoints.forEach((point, index) => {\n\t\t\t\t\tlet oldId = point.id;\n\t\t\t\t\tpoint.id = 'p' + this.id + '_' + index;\n\t\t\t\t\tthis.getElement('#' + oldId).id = point.id;\n\t\t\t\t\tthis.getElement('#x' + oldId).id = 'x' + point.id;\n\t\t\t\t\tthis.getElement('#y' + oldId).id = 'y' + point.id;\n\t\t\t\t\tthis.getElement('[for=\"x' + oldId + '\"]').setAttribute('for', 'x' + point.id);\n\t\t\t\t\tthis.getElement('[for=\"y' + oldId + '\"]').setAttribute('for', 'y' + point.id);\n\t\t\t\t\tcontrols[index].name = index;\n\t\t\t\t});\n\n\t\t\t\tthis.points = points;\n\t\t\t\tthis.controls = controls;\n\t\t\t\tthis.canvas.renderAll();\n\t\t\t}\n\t\t}\n\n\t\tstatic addElementToArrayWithPosition(array, item, newPointIndex) {\n\t\t\tif (newPointIndex < 0) {\n\t\t\t\tarray.unshift(item);\n\t\t\t} else if (newPointIndex >= array.length) {\n\t\t\t\tarray.push(item);\n\t\t\t} else {\n\t\t\t\tlet newPoints = [];\n\t\t\t\tfor (let i = 0; i < array.length; i++) {\n\t\t\t\t\tnewPoints.push(array[i]);\n\t\t\t\t\tif (i === newPointIndex - 1) {\n\t\t\t\t\t\tnewPoints.push(item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tarray = newPoints;\n\t\t\t}\n\t\t\treturn array;\n\t\t}\n\t}\n\n\tclass AreaForm {\n\t\t/**\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tareaZone = null;\n\n\t\t/**\n\t\t * @type {AreaEditor}\n\t\t */\n\t\teditor = null;\n\n\t\t/**\n\t\t * Element needed to add inputs that act as target for browselink finalizeFunction target\n\t\t *\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tfauxForm = null;\n\n\t\tconstructor(formElement, editor) {\n\t\t\tthis.element = editor.document.querySelector(formElement);\n\t\t\tthis.areaZone = this.element.querySelector('#areaZone');\n\t\t\tthis.editor = editor;\n\n\t\t\tthis.addFauxFormForLinkBrowser(this.editor.browseLink);\n\t\t}\n\n\t\tdestroy() {\n\t\t\tthis.removeFauxForm();\n\t\t}\n\n\t\tinitializeArrows() {\n\t\t\tthis.editor.areas.forEach((area) => {\n\t\t\t\tarea.initializeArrows();\n\t\t\t});\n\t\t}\n\n\t\taddArea(area) {\n\t\t\tarea.form = this;\n\t\t\tarea.postAddToForm();\n\t\t}\n\n\t\tmoveArea(area, offset) {\n\t\t\tlet index = this.editor.areas.indexOf(area),\n\t\t\t\tnewIndex = index + offset,\n\t\t\t\tparent = area.element.parentNode;\n\n\t\t\tif (newIndex > -1 && newIndex < this.editor.areas.length) {\n\t\t\t\tlet removedArea = this.editor.areas.splice(index, 1)[0];\n\t\t\t\tthis.editor.areas.splice(newIndex, 0, removedArea);\n\n\t\t\t\tparent.childNodes[index][offset < 0 ? 'after' : 'before'](parent.childNodes[newIndex]);\n\t\t\t}\n\n\t\t\tthis.initializeArrows();\n\t\t}\n\n\t\topenLinkBrowser(link, area) {\n\t\t\tlink.blur();\n\n\t\t\tlet data = {\n\t\t\t\t...this.editor.browseLink,\n\t\t\t\tobjectId: area.id,\n\t\t\t\titemName: 'link' + area.id,\n\t\t\t\tcurrentValue: area.getLink()\n\t\t\t};\n\n\t\t\t$.ajax({\n\t\t\t\turl: this.editor.browseLinkUrlAjaxUrl,\n\t\t\t\tcontext: area,\n\t\t\t\tdata: data\n\t\t\t}).done((response) => {\n\t\t\t\tlet vHWin = window.open(\n\t\t\t\t\tresponse.url,\n\t\t\t\t\t'',\n\t\t\t\t\t'height=600,width=500,status=0,menubar=0,scrollbars=1'\n\t\t\t\t);\n\t\t\t\tvHWin.focus()\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Triggers change event after faux field was changed by browselink\n\t\t */\n\t\taddFauxFormForLinkBrowser() {\n\t\t\tif (top.document !== this.editor.fauxFormDocument) {\n\t\t\t\tthis.fauxForm = this.editor.fauxFormDocument.createElement('form');\n\t\t\t\tthis.fauxForm.setAttribute('name', this.editor.browseLink.formName);\n\n\t\t\t\tlet fauxFormContainer = this.editor.fauxFormDocument.querySelector('#fauxFormContainer');\n\t\t\t\twhile (fauxFormContainer.firstChild) {\n\t\t\t\t\tfauxFormContainer.removeChild(fauxFormContainer.firstChild);\n\t\t\t\t}\n\t\t\t\tfauxFormContainer.appendChild(this.fauxForm);\n\t\t\t}\n\t\t}\n\n\t\tremoveFauxForm() {\n\t\t\tif (this.fauxForm) {\n\t\t\t\tthis.fauxForm.remove();\n\t\t\t}\n\t\t}\n\n\t\tsyncAreaLinkValue(id) {\n\t\t\tthis.editor.areas.forEach((area) => {\n\t\t\t\tif (area.id === parseInt(id)) {\n\t\t\t\t\tarea.link = area.getElement('.link').value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tclass AreaEditor {\n\t\tareaConfig = {\n\t\t\tcornerColor: '#eee',\n\t\t\tcornerStrokeColor: '#bbb',\n\t\t\tcornerSize: 10,\n\t\t\tcornerStyle: 'circle',\n\t\t\thasBorders: false,\n\t\t\thasRotatingPoint: false,\n\t\t\ttransparentCorners: false\n\t\t};\n\n\t\t/**\n\t\t * @type {Document}\n\t\t */\n\t\tdocument = null;\n\n\t\t/**\n\t\t * @type {Document}\n\t\t */\n\t\tfauxFormDocument = null;\n\n\t\t/**\n\t\t * @type {string}\n\t\t */\n\t\tbrowseLinkUrlAjaxUrl = '';\n\n\t\t/**\n\t\t * @type {object}\n\t\t */\n\t\tbrowseLink = null;\n\n\t\t/**\n\t\t * @type {boolean}\n\t\t */\n\t\tpreview = true;\n\n\t\t/**\n\t\t * @type {Array}\n\t\t */\n\t\tareas = [];\n\n\t\tconstructor(options, canvasSelector, formSelector, document) {\n\t\t\tthis.setOptions(options);\n\n\t\t\tthis.document = document;\n\t\t\tthis.preview = formSelector === '';\n\n\t\t\tthis.initializeCanvas(canvasSelector, options);\n\n\t\t\tif (!this.preview) {\n\t\t\t\tthis.form = new AreaForm(formSelector, this);\n\t\t\t}\n\t\t}\n\n\t\tsetOptions(options) {\n\t\t\tfor (let option in options) {\n\t\t\t\tif (options.hasOwnProperty(option)) {\n\t\t\t\t\tthis[option] = options[option];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsetScale(scaling) {\n\t\t\tthis.canvas.setZoom(this.canvas.getZoom() * (scaling ? scaling : 1));\n\t\t}\n\n\t\tinitializeCanvas(canvasSelector, options) {\n\t\t\tthis.canvas = new fabric.Canvas(canvasSelector, {\n\t\t\t\t...options.canvas,\n\t\t\t\tselection: false,\n\t\t\t\tpreserveObjectStacking: true,\n\t\t\t\thoverCursor: this.preview ? 'default' : 'move',\n\t\t\t});\n\n\t\t\tthis.canvas.on('object:moving', (event) => {\n\t\t\t\tlet element = event.target;\n\t\t\t\tswitch (element.type) {\n\t\t\t\t\tcase 'control':\n\t\t\t\t\t\tlet center = element.getCenterPoint();\n\t\t\t\t\t\telement.point.x = center.x - element.polygon.left;\n\t\t\t\t\t\telement.point.y = center.y - element.polygon.top;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'polygon':\n\t\t\t\t\t\telement.controls.forEach((control) => {\n\t\t\t\t\t\t\tcontrol.left = element.left + control.point.x;\n\t\t\t\t\t\t\tcontrol.top = element.top + control.point.y;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet activePolygon = null;\n\t\t\tthis.canvas.on('selection:created', (event) => {\n\t\t\t\tif (event.target.type === 'polygon') {\n\t\t\t\t\tactivePolygon = event.target;\n\t\t\t\t\t// show controls of active polygon\n\t\t\t\t\tactivePolygon.controls.forEach((control) => {\n\t\t\t\t\t\tcontrol.opacity = 1;\n\t\t\t\t\t});\n\t\t\t\t\tthis.canvas.renderAll();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.canvas.on('selection:updated', (event) => {\n\t\t\t\tevent.deselected.forEach((element) => {\n\t\t\t\t\tif (element.type === 'polygon' && event.selected[0].type !== 'control') {\n\t\t\t\t\t\t// hide controls of active polygon\n\t\t\t\t\t\telement.controls.forEach((control) => {\n\t\t\t\t\t\t\tcontrol.opacity = 0;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tactivePolygon = null;\n\t\t\t\t\t\tthis.canvas.renderAll();\n\t\t\t\t\t} else if (element.type === 'control') {\n\t\t\t\t\t\t// hide controls of active polygon\n\t\t\t\t\t\tactivePolygon.controls.forEach((control) => {\n\t\t\t\t\t\t\tcontrol.opacity = 0;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tactivePolygon = null;\n\t\t\t\t\t\tthis.canvas.renderAll();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tevent.selected.forEach((element) => {\n\t\t\t\t\tif (element.type === 'polygon') {\n\t\t\t\t\t\tactivePolygon = element;\n\t\t\t\t\t\t// hide controls of active polygon\n\t\t\t\t\t\telement.controls.forEach((control) => {\n\t\t\t\t\t\t\tcontrol.opacity = 1;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.canvas.renderAll();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tinitializeAreas(areas) {\n\t\t\tif (areas !== undefined) {\n\t\t\t\tareas.forEach((area) => {\n\t\t\t\t\tarea.color = AreaEditor.getRandomColor(area.color);\n\t\t\t\t\tlet configuration = {\n\t\t\t\t\t\t...area,\n\t\t\t\t\t\t...this.areaConfig,\n\t\t\t\t\t\tselectable: !this.preview,\n\t\t\t\t\t\thasControls: !this.preview,\n\t\t\t\t\t\tstroke: area.color,\n\t\t\t\t\t\tstrokeWidth: 1,\n\t\t\t\t\t\tfill: AreaEditor.hexToRgbA(area.color, 0.3)\n\t\t\t\t\t};\n\n\t\t\t\t\tswitch (configuration.shape) {\n\t\t\t\t\t\tcase 'rect':\n\t\t\t\t\t\t\tarea = this.addRect(configuration);\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'circle':\n\t\t\t\t\t\t\tarea = this.addCircle(configuration);\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'poly':\n\t\t\t\t\t\t\tarea = this.addPoly(configuration);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tarea.editor = this;\n\t\t\t\t\tthis.areas.push(area);\n\t\t\t\t\tif (this.form) {\n\t\t\t\t\t\tthis.form.addArea(area);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tremoveAllAreas() {\n\t\t\tthis.areas.forEach((area) => { area.deleteAction(); });\n\t\t}\n\n\t\taddRect(configuration) {\n\t\t\tlet [left, top, right, bottom] = configuration.coords.split(','),\n\t\t\t\tarea = new Rect({\n\t\t\t\t\t...configuration,\n\t\t\t\t\tleft: parseInt(left),\n\t\t\t\t\ttop: parseInt(top),\n\t\t\t\t\twidth: right - left,\n\t\t\t\t\theight: bottom - top,\n\t\t\t\t});\n\n\t\t\tthis.canvas.add(area);\n\t\t\treturn area;\n\t\t}\n\n\t\taddCircle(configuration) {\n\t\t\tlet [left, top, radius] = configuration.coords.split(','),\n\t\t\t\tarea = new Circle({\n\t\t\t\t\t...configuration,\n\t\t\t\t\tleft: left - radius,\n\t\t\t\t\ttop: top - radius,\n\t\t\t\t\tradius: parseInt(radius),\n\t\t\t\t});\n\n\t\t\t// disable control points as these would stretch the circle\n\t\t\t// to an ellipse which is not possible in html areas\n\t\t\tarea.setControlVisible('ml', false);\n\t\t\tarea.setControlVisible('mt', false);\n\t\t\tarea.setControlVisible('mr', false);\n\t\t\tarea.setControlVisible('mb', false);\n\n\t\t\tthis.canvas.add(area);\n\t\t\treturn area;\n\t\t}\n\n\t\taddPoly(configuration) {\n\t\t\tlet area = new Poly([], {\n\t\t\t\t...configuration,\n\t\t\t\tselectable: true,\n\t\t\t\thasControls: false,\n\t\t\t\tobjectCaching: false,\n\t\t\t\tcontrolConfig: this.areaConfig,\n\t\t\t});\n\n\t\t\tthis.canvas.add(area);\n\t\t\tif (this.form) {\n\t\t\t\tarea.addControls();\n\t\t\t}\n\t\t\treturn area;\n\t\t}\n\n\t\ttriggerLinkChanged(id) {\n\t\t\tlet selector = 'form[name=\"' + this.browseLink.formName + '\"] [data-formengine-input-name=\"link' + id + '\"]',\n\t\t\t\tfield = this.fauxFormDocument.querySelector(selector),\n\t\t\t\tevent = this.fauxFormDocument.createEvent('HTMLEvents');\n\t\t\tevent.initEvent('change', false, true);\n\t\t\tfield.dispatchEvent(event);\n\t\t}\n\n\t\tdeleteArea(area) {\n\t\t\tlet areas = [];\n\t\t\tthis.areas.forEach((currentArea) => {\n\t\t\t\tif (area !== currentArea) {\n\t\t\t\t\tareas.push(currentArea);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.areas = areas;\n\t\t\tthis.canvas.remove(area);\n\t\t}\n\n\t\ttoAreaXml() {\n\t\t\tlet xml = ['<map>'];\n\t\t\tthis.areas.forEach((area) => {\n\t\t\t\txml.push(area.toAreaXml());\n\t\t\t});\n\t\t\txml.push('</map>');\n\t\t\treturn xml.join(\"\\n\");\n\t\t}\n\n\t\tstatic getRandomColor(color) {\n\t\t\tif (color === undefined) {\n\t\t\t\tlet r = (Math.floor(Math.random() * 5) * 3).toString(16),\n\t\t\t\t\tg = (Math.floor(Math.random() * 5) * 3).toString(16),\n\t\t\t\t\tb = (Math.floor(Math.random() * 5) * 3).toString(16);\n\t\t\t\tcolor = '#' + r + r + g + g + b + b;\n\t\t\t}\n\t\t\treturn color;\n\t\t}\n\n\t\tstatic hexToRgbA(hex, alpha) {\n\t\t\tlet chars, r, g, b, result;\n\t\t\tif (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\n\t\t\t\tchars = hex.substring(1).split('');\n\t\t\t\tif (chars.length === 3) {\n\t\t\t\t\tchars = [chars[0], chars[0], chars[1], chars[1], chars[2], chars[2]];\n\t\t\t\t}\n\n\t\t\t\tr = parseInt(chars[0] + chars[1], 16);\n\t\t\t\tg = parseInt(chars[2] + chars[3], 16);\n\t\t\t\tb = parseInt(chars[4] + chars[5], 16);\n\n\t\t\t\tif (alpha) {\n\t\t\t\t\tresult = 'rgba(' + [r, g, b, alpha].join(', ') + ')';\n\t\t\t\t} else {\n\t\t\t\t\tresult = 'rgb(' + [r, g, b].join(', ') + ')';\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\tthrow new Error('Bad Hex');\n\t\t}\n\t}\n\n\treturn AreaEditor;\n});\n\n"]}